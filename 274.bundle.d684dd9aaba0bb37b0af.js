/*! For license information please see 274.bundle.d684dd9aaba0bb37b0af.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[274],{8274:(t,e,n)=>{"use strict";n.r(e);var r=n(76),i=n(1549),o=n(7474),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var a,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},h=h||{},f=c||self;function l(){}function p(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function _(){return Date.now()}function E(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function I(){this.j=this.j,this.i=this.i}I.prototype.j=!1,I.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++y)}(this)},I.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var T=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},N=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function A(t){return Array.prototype.concat.apply([],arguments)}function S(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function x(t){return/^[\s\xa0]*$/.test(t)}var D,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function P(t,e){return t<e?-1:t>e?1:0}t:{var C=f.navigator;if(C){var L=C.userAgent;if(L){D=L;break t}}D=""}function R(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function V(t){var e={};for(var n in t)e[n]=t[n];return e}var M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<M.length;o++)n=M[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function G(t){return G[" "](t),t}G[" "]=l;var j,F,q=O(D,"Opera"),z=O(D,"Trident")||O(D,"MSIE"),B=O(D,"Edge"),J=B||z,H=O(D,"Gecko")&&!(O(D.toLowerCase(),"webkit")&&!O(D,"Edge"))&&!(O(D,"Trident")||O(D,"MSIE"))&&!O(D,"Edge"),Q=O(D.toLowerCase(),"webkit")&&!O(D,"Edge");function Y(){var t=f.document;return t?t.documentMode:void 0}t:{var K="",X=(F=D,H?/rv:([^\);]+)(\)|;)/.exec(F):B?/Edge\/([\d\.]+)/.exec(F):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(F):Q?/WebKit\/(\S+)/.exec(F):q?/(?:Version)[ \/]?(\S+)/.exec(F):void 0);if(X&&(K=X?X[1]:""),z){var Z=Y();if(null!=Z&&Z>parseFloat(K)){j=String(Z);break t}}j=K}var W,$={};function tt(t){return function(t,e){var n=$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=k(String(j)).split("."),r=k(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=P(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||P(0==s[2].length,0==u[2].length)||P(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}f.document&&z?W=Y()||parseInt(j,10)||void 0:W=void 0;var et=W,nt=!z||9<=Number(et),rt=z&&!tt("9"),it=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{f.addEventListener("test",l,e),f.removeEventListener("test",l,e)}catch(t){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function st(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{G(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ut[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.defaultPrevented=!0},E(st,ot);var ut={2:"touch",3:"pen",4:"mouse"};st.prototype.b=function(){st.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var at="closure_listenable_"+(1e6*Math.random()|0),ct=0;function ht(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ct,this.Y=this.Z=!1}function ft(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function lt(t){this.src=t,this.a={},this.b=0}function pt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=T(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ft(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ht(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var vt="closure_lm_"+(1e6*Math.random()|0),yt={};function mt(t,e,n,r,i){if(r&&r.once)return wt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)mt(t,e[o],n,r,i);return null}return n=St(n),t&&t[at]?t.va(e,n,d(r)?!!r.capture:!!r,i):gt(t,e,n,!1,r,i)}function gt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=d(i)?!!i.capture:!!i;if(s&&!nt)return null;var u=Nt(t);if(u||(t[vt]=u=new lt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Tt,e=nt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)it||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Et(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function wt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)wt(t,e[o],n,r,i);return null}return n=St(n),t&&t[at]?t.wa(e,n,d(r)?!!r.capture:!!r,i):gt(t,e,n,!0,r,i)}function bt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=St(n),t&&t[at]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=dt(o=t.a[e],n,r,i))&&(ft(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Nt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=dt(e,n,r,i)),(n=-1<t?e[t]:null)&&_t(n))}function _t(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[at])pt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Et(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Nt(e))?(pt(n,t),0==n.b&&(n.src=null,e[vt]=null)):ft(t)}}}function Et(t){return t in yt?yt[t]:yt[t]="on"+t}function It(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Tt(t,e){if(t.Y)return!0;if(!nt){if(!e)t:{e=["window","event"];for(var n=f,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return It(t,e=new st(e,this))}return It(t,new st(e,this))}function Nt(t){return(t=t[vt])instanceof lt?t:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"==typeof t?t:(t[At]||(t[At]=function(e){return t.handleEvent(e)}),t[At])}function xt(){I.call(this),this.c=new lt(this),this.J=this,this.C=null}function Dt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new ot(e,t);else if(e instanceof ot)e.target=e.target||t;else{var i=e;U(e=new ot(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=kt(s,r,!0,e)&&i}if(i=kt(s=e.a=t,r,!0,e)&&i,i=kt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=kt(s=e.a=n[o],r,!1,e)&&i}function kt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&pt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}E(xt,I),xt.prototype[at]=!0,(a=xt.prototype).addEventListener=function(t,e,n,r){mt(this,t,e,n,r)},a.removeEventListener=function(t,e,n,r){bt(this,t,e,n,r)},a.G=function(){if(xt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ft(n[r]);delete e.a[t],e.b--}}this.C=null},a.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},a.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ot=f.JSON.stringify;function Pt(){this.b=this.a=null}var Ct,Lt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Vt}),(function(t){t.reset()}));function Rt(){var t=jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Vt(){this.next=this.b=this.a=null}function Mt(t){f.setTimeout((function(){throw t}),0)}function Ut(t,e){Ct||function(){var t=f.Promise.resolve(void 0);Ct=function(){t.then(Ft)}}(),Gt||(Ct(),Gt=!0),jt.add(t,e)}Pt.prototype.add=function(t,e){var n=Lt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Vt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Vt.prototype.reset=function(){this.next=this.b=this.a=null};var Gt=!1,jt=new Pt;function Ft(){for(var t;t=Rt();){try{t.a.call(t.b)}catch(t){Mt(t)}var e=Lt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Gt=!1}function qt(t,e){xt.call(this),this.b=t||1,this.a=e||f,this.f=w(this.Za,this),this.g=_()}function zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Bt(t,e,n){if("function"==typeof t)n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:f.setTimeout(t,e||0)}function Jt(t){t.a=Bt((function(){t.a=null,t.c&&(t.c=!1,Jt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}E(qt,xt),(a=qt.prototype).aa=!1,a.M=null,a.Za=function(){if(this.aa){var t=_()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Dt(this,"tick"),this.aa&&(zt(this),this.start()))}},a.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=_())},a.G=function(){qt.X.G.call(this),zt(this),delete this.a};var Ht=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Jt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(f.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(I);function Qt(t){I.call(this),this.b=t,this.a={}}E(Qt,I);var Yt=[];function Kt(t,e,n,r){Array.isArray(n)||(n&&(Yt[0]=n.toString()),n=Yt);for(var i=0;i<n.length;i++){var o=mt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Xt(t){R(t.a,(function(t,e){this.a.hasOwnProperty(e)&&_t(t)}),t),t.a={}}function Zt(){this.a=!0}function Wt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ot(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Qt.prototype.G=function(){Qt.X.G.call(this),Xt(this)},Qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Zt.prototype.info=function(){};var $t={},te=null;function ee(){return te=te||new xt}function ne(t){ot.call(this,$t.Fa,t)}function re(t){var e=ee();Dt(e,new ne(e,t))}function ie(t,e){ot.call(this,$t.STAT_EVENT,t),this.stat=e}function oe(t){var e=ee();Dt(e,new ie(e,t))}function se(t){ot.call(this,$t.Ga,t)}function ue(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return f.setTimeout((function(){t()}),e)}$t.Fa="serverreachability",E(ne,ot),$t.STAT_EVENT="statevent",E(ie,ot),$t.Ga="timingevent",E(se,ot);var ae={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ce={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function he(){}function fe(t){var e;return(e=t.a)||(e=t.a={}),e}function le(){}he.prototype.a=null;var pe,de={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ve(){ot.call(this,"d")}function ye(){ot.call(this,"c")}function me(){}function ge(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Qt(this),this.P=we,t=J?125:void 0,this.R=new qt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}E(ve,ot),E(ye,ot),E(me,he),pe=new me;var we=45e3,be={},_e={};function Ee(t,e,n){t.H=1,t.i=Be(Ue(e)),t.j=n,t.I=!0,Ie(t,null)}function Ie(t,e){t.u=_(),Ae(t),t.l=Ue(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),rn(n.b,"t",r),t.D=0,t.a=Wn(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ht(w(t.Ca,t,t.a),t.O)),Kt(t.J,t.a,"readystatechange",t.Xa),e=t.B?V(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),re(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Te(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ne(t,n);if(i==_e){4==e&&(t.h=4,oe(14),r=!1),Wt(t.c,t.f,null,"[Incomplete Response]");break}if(i==be){t.h=4,oe(15),Wt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Wt(t.c,t.f,i,null),Oe(t,i)}4==e&&0==n.length&&(t.h=1,oe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bn(e),e.F=!0,oe(11))):(Wt(t.c,t.f,n,"[Invalid Chunked Response]"),ke(t),De(t))}function Ne(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?_e:(n=Number(e.substring(n,r)),isNaN(n)?be:(r+=1)+n>e.length?_e:(e=e.substr(r,n),t.D=r+n,e))}function Ae(t){t.T=_()+t.P,Se(t,t.P)}function Se(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ue(w(t.Va,t),e)}function xe(t){t.o&&(f.clearTimeout(t.o),t.o=null)}function De(t){0==t.g.v||t.A||Qn(t.g,t)}function ke(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,zt(t.R),Xt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Oe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||fn(n.b,t)))if(n.I=t.N,!t.C&&fn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Hn(n),Rn(n)}zn(n),oe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ue(w(n.Sa,n),6e3));if(1>=hn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Kn(n,11)}else if((t.C||n.a==t)&&Hn(n),!x(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(O(h,"spdy")||O(h,"quic")||O(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(ln(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,ze(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=_()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=Zn(a,a.C?a.ga:null,a.fa),p.C){pn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(xe(d),Ae(d)),a.a=p}else qn(a);0<n.g.length&&Un(n)}else"stop"!=i[0]&&"close"!=i[0]||Kn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Kn(n,7):Ln(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);re(4)}catch(t){}}function Pe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)N(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(p(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ce(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ce)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Le(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Re(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Re(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Re(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(a=ge.prototype).setTimeout=function(t){this.P=t},a.Xa=function(t){t=t.target;var e=this.F;e&&3==kn(t)?e.f():this.Ca(t)},a.Ca=function(t){try{if(t==this.a)t:{var e=kn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!J&&!this.a.$())){this.A||4!=e||7==n||re(8==n||0>=r?3:2),xe(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,oe(12),ke(this),De(this);break t}Wt(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Oe(this,a)}this.I?(Te(this,e,o),J&&this.b&&3==e&&(Kt(this.J,this.R,"tick",this.Wa),this.R.start())):(Wt(this.c,this.f,o,null),Oe(this,o)),4==e&&ke(this),this.b&&!this.A&&(4==e?Qn(this.g,this):(this.b=!1,Ae(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),ke(this),De(this)}}}catch(t){}},a.Wa=function(){if(this.a){var t=kn(this.a),e=this.a.$();this.D<e.length&&(xe(this),Te(this,t,e),this.b&&4!=t&&Ae(this))}},a.cancel=function(){this.A=!0,ke(this)},a.Va=function(){this.o=null;var t=_();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(re(3),oe(17)),ke(this),this.h=2,De(this)):Se(this,this.T-t)},(a=Ce.prototype).K=function(){Le(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},a.L=function(){return Le(this),this.a.concat()},a.get=function(t,e){return Re(this.b,t)?this.b[t]:e},a.set=function(t,e){Re(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},a.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ve=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Me(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Me){this.a=void 0!==e?e:t.a,Ge(this,t.f),this.j=t.j,je(this,t.c),Fe(this,t.h),this.g=t.g,e=t.b;var n=new $e;n.c=e.c,e.a&&(n.a=new Ce(e.a),n.b=e.b),qe(this,n),this.i=t.i}else t&&(n=String(t).match(Ve))?(this.a=!!e,Ge(this,n[1]||"",!0),this.j=Je(n[2]||""),je(this,n[3]||"",!0),Fe(this,n[4]),this.g=Je(n[5]||"",!0),qe(this,n[6]||"",!0),this.i=Je(n[7]||"")):(this.a=!!e,this.b=new $e(null,this.a))}function Ue(t){return new Me(t)}function Ge(t,e,n){t.f=n?Je(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function je(t,e,n){t.c=n?Je(e,!0):e}function Fe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function qe(t,e,n){e instanceof $e?(t.b=e,function(t,e){e&&!t.f&&(tn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(en(this,e),rn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=He(e,Ze)),t.b=new $e(e,t.a))}function ze(t,e,n){t.b.set(e,n)}function Be(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36)),t}function Je(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Qe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Qe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Me.prototype.toString=function(){var t=[],e=this.f;e&&t.push(He(e,Ye,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(He(e,Ye,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?Xe:Ke,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",He(n,We)),t.join("")};var Ye=/[#\/\?@]/g,Ke=/[#\?:]/g,Xe=/[#\?]/g,Ze=/[#\?@]/g,We=/#/g;function $e(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function tn(t){t.a||(t.a=new Ce,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function en(t,e){tn(t),e=on(t,e),Re(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Re((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Le(t)))}function nn(t,e){return tn(t),e=on(t,e),Re(t.a.b,e)}function rn(t,e,n){en(t,e),0<n.length&&(t.c=null,t.a.set(on(t,e),S(n)),t.b+=n.length)}function on(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(a=$e.prototype).add=function(t,e){tn(this),this.c=null,t=on(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},a.forEach=function(t,e){tn(this),this.a.forEach((function(n,r){N(n,(function(n){t.call(e,n,r,this)}),this)}),this)},a.L=function(){tn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},a.K=function(t){tn(this);var e=[];if("string"==typeof t)nn(this,t)&&(e=A(e,this.a.get(on(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=A(e,t[n])}return e},a.set=function(t,e){return tn(this),this.c=null,nn(this,t=on(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},a.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},a.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var sn=function(t,e){this.b=t,this.a=e};function un(t){this.g=t||an,t=f.PerformanceNavigationTiming?0<(t=f.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(f.ia&&f.ia.ya&&f.ia.ya()&&f.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var an=10;function cn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function hn(t){return t.b?1:t.a?t.a.size:0}function fn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function ln(t,e){t.a?t.a.add(e):t.b=e}function pn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=u(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return S(t.c)}function vn(){}function yn(){this.a=new vn}function mn(t,e,n){var r=n||"";try{Pe(t,(function(t,n){var i=t;d(t)&&(i=Ot(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function gn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}un.prototype.cancel=function(){var t,e;if(this.c=dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=u(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},vn.prototype.stringify=function(t){return f.JSON.stringify(t,void 0)},vn.prototype.parse=function(t){return f.JSON.parse(t,void 0)};var wn=f.JSON.parse;function bn(t){xt.call(this),this.headers=new Ce,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=_n,this.D=this.F=!1}E(bn,xt);var _n="",En=/^https?$/i,In=["POST","PUT"];function Tn(t){return"content-type"==t.toLowerCase()}function Nn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,An(t),xn(t)}function An(t){t.u||(t.u=!0,Dt(t,"complete"),Dt(t,"error"))}function Sn(t){if(t.b&&void 0!==h&&(!t.s[1]||4!=kn(t)||2!=t.W()))if(t.l&&4==kn(t))Bt(t.za,0,t);else if(Dt(t,"readystatechange"),4==kn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ve)[1]||null;if(!o&&f.self&&f.self.location){var s=f.self.location.protocol;o=s.substr(0,s.length-1)}i=!En.test(o?o.toLowerCase():"")}e=i}if(e)Dt(t,"complete"),Dt(t,"success");else{t.h=6;try{var u=2<kn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",An(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Dn(t);var n=t.a,r=t.s[0]?l:null;t.a=null,t.s=null,e||Dt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Dn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(f.clearTimeout(t.m),t.m=null)}function kn(t){return t.a?t.a.readyState:0}function On(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return R(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ze(t,e,n))}function Pn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Cn(t){this.pa=0,this.g=[],this.c=new Zt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Pn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Pn("baseRetryDelayMs",5e3,t),this.Ra=Pn("retryDelaySeedMs",1e4,t),this.Ma=Pn("forwardChannelMaxRetries",2,t),this.ma=Pn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new un(t&&t.concurrentRequestLimit),this.ka=new yn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ln(t){if(Vn(t),3==t.v){var e=t.R++,n=Ue(t.B);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),jn(t,n),(e=new ge(t,t.c,e,void 0)).H=2,e.i=Be(Ue(n)),n=!1,f.navigator&&f.navigator.sendBeacon&&(n=f.navigator.sendBeacon(e.i.toString(),"")),!n&&f.Image&&((new Image).src=e.i,n=!0),n||(e.a=Wn(e.g,null),e.a.ba(e.i)),e.u=_(),Ae(e)}Xn(t)}function Rn(t){t.a&&(Bn(t),t.a.cancel(),t.a=null)}function Vn(t){Rn(t),t.j&&(f.clearTimeout(t.j),t.j=null),Hn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&f.clearTimeout(t.h),t.h=null)}function Mn(t,e){t.g.push(new sn(t.Oa++,e)),3==t.v&&Un(t)}function Un(t){cn(t.b)||t.h||(t.h=!0,Ut(t.Ba,t),t.u=0)}function Gn(t,e){var n;n=e?e.f:t.R++;var r=Ue(t.B);ze(r,"SID",t.J),ze(r,"RID",n),ze(r,"AID",t.P),jn(t,r),t.i&&t.l&&On(r,t.i,t.l),n=new ge(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Fn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),ln(t.b,n),Ee(n,r,e)}function jn(t,e){t.f&&Pe({},(function(t,n){ze(e,n,t)}))}function Fn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?w(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{mn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function qn(t){t.a||t.j||(t.T=1,Ut(t.Aa,t),t.o=0)}function zn(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=ue(w(t.Aa,t),Yn(t,t.o)),t.o++,0))}function Bn(t){null!=t.s&&(f.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new ge(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ue(t.la);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.H?"0":"1"),ze(e,"AID",t.P),jn(t,e),ze(e,"TYPE","xmlhttp"),t.i&&t.l&&On(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Be(Ue(e)),n.j=null,n.I=!0,Ie(n,t)}function Hn(t){null!=t.m&&(f.clearTimeout(t.m),t.m=null)}function Qn(t,e){var n=null;if(t.a==e){Hn(t),Bn(t),t.a=null;var r=2}else{if(!fn(t.b,e))return;n=e.s,pn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=_()-e.u;var i=t.u;Dt(r=ee(),new se(r,n,e,i)),Un(t)}else qn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(hn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ue(w(t.Ba,t,e),Yn(t,t.u)),t.u++,0)))}(t,e)||2==r&&zn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Kn(t,5);break;case 4:Kn(t,10);break;case 3:Kn(t,6);break;default:Kn(t,2)}}function Yn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Kn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=w(t.Ya,t);n||(n=new Me("//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||Ge(n,"https"),Be(n)),function(t,e){var n=new Zt;if(f.Image){var r=new Image;r.onload=b(gn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=b(gn,n,r,"TestLoadImage: error",!1,e),r.onabort=b(gn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=b(gn,n,r,"TestLoadImage: timeout",!1,e),f.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else oe(2);t.v=0,t.f&&t.f.ra(e),Xn(t),Vn(t)}function Xn(t){t.v=0,t.I=-1,t.f&&(0==dn(t.b).length&&0==t.g.length||(t.b.c.length=0,S(t.g),t.g.length=0),t.f.qa())}function Zn(t,e,n){var r=function(t){return t instanceof Me?Ue(t):new Me(t,void 0)}(n);if(""!=r.c)e&&je(r,e+"."+r.c),Fe(r,r.h);else{var i=f.location;r=function(t,e,n,r){var i=new Me(null,void 0);return t&&Ge(i,t),e&&je(i,e),n&&Fe(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&R(t.V,(function(t,e){ze(r,e,t)})),e=t.A,n=t.na,e&&n&&ze(r,e,n),ze(r,"VER",t.ha),jn(t,r),r}function Wn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new bn(t.Na)).F=t.C,e}function $n(){}function tr(){if(z&&!(10<=Number(et)))throw Error("Environmental error: no available transport.")}function er(t,e){xt.call(this),this.a=new Cn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!x(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!x(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new ir(this)}function nr(t){ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){ye.call(this),this.status=1}function ir(t){this.a=t}(a=bn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?fe(this.H):fe(pe),this.a.onreadystatechange=w(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Nn(this,t)}t=n||"";var i=new Ce(this.headers);r&&Pe(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Tn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=f.FormData&&t instanceof f.FormData,!(0<=T(In,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Dn(this),0<this.o&&((this.D=function(t){return z&&tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=w(this.xa,this)):this.m=Bt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Nn(this,t)}},a.xa=function(){void 0!==h&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Dt(this,"timeout"),this.abort(8))},a.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Dt(this,"complete"),Dt(this,"abort"),xn(this))},a.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),bn.X.G.call(this)},a.za=function(){this.j||(this.A||this.l||this.g?Sn(this):this.Ua())},a.Ua=function(){Sn(this)},a.W=function(){try{return 2<kn(this)?this.a.status:-1}catch(t){return-1}},a.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},a.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),wn(e)}},a.ua=function(){return this.h},a.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(a=Cn.prototype).ha=8,a.v=1,a.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ge(this,this.c,t,void 0),r=this.l;if(this.O&&(r?U(r=V(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Fn(this,n,e),ze(i=Ue(this.B),"RID",t),ze(i,"CVER",22),this.A&&ze(i,"X-HTTP-Session-Id",this.A),jn(this,i),this.i&&r&&On(i,this.i,r),ln(this.b,n),this.Ia&&ze(i,"TYPE","init"),this.da?(ze(i,"$req",e),ze(i,"SID","null"),n.U=!0,Ee(n,i,null)):Ee(n,i,e),this.v=2}}else 3==this.v&&(t?Gn(this,t):0==this.g.length||cn(this.b)||Gn(this))},a.Aa=function(){if(this.j=null,Jn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ue(w(this.Ta,this),t)}},a.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,oe(10),Rn(this),Jn(this))},a.Sa=function(){null!=this.m&&(this.m=null,Rn(this),zn(this),oe(19))},a.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(a=$n.prototype).ta=function(){},a.sa=function(){},a.ra=function(){},a.qa=function(){},a.Ja=function(){},tr.prototype.a=function(t,e){return new er(t,e)},E(er,xt),er.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;oe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Zn(t,null,t.fa),Un(t)},er.prototype.close=function(){Ln(this.a)},er.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Mn(this.a,e)}else this.l?((e={}).__data__=Ot(t),Mn(this.a,e)):Mn(this.a,t)},er.prototype.G=function(){this.a.f=null,delete this.f,Ln(this.a),delete this.a,er.X.G.call(this)},E(nr,ve),E(rr,ye),E(ir,$n),ir.prototype.ta=function(){Dt(this.a,"a")},ir.prototype.sa=function(t){Dt(this.a,new nr(t))},ir.prototype.ra=function(t){Dt(this.a,new rr(t))},ir.prototype.qa=function(){Dt(this.a,"b")},tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.h,er.prototype.open=er.prototype.g,er.prototype.close=er.prototype.close,ae.NO_ERROR=0,ae.TIMEOUT=8,ae.HTTP_ERROR=6,ce.COMPLETE="complete",le.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",xt.prototype.listen=xt.prototype.va,bn.prototype.listenOnce=bn.prototype.wa,bn.prototype.getLastError=bn.prototype.Qa,bn.prototype.getLastErrorCode=bn.prototype.ua,bn.prototype.getStatus=bn.prototype.W,bn.prototype.getResponseJson=bn.prototype.Pa,bn.prototype.getResponseText=bn.prototype.$,bn.prototype.send=bn.prototype.ba;var or=ae,sr=ce,ur=$t,ar=10,cr=11,hr=le,fr=bn,lr=n(9312),pr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},dr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),vr=new i.Yd("@firebase/firestore");function yr(){return vr.logLevel}function mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.DEBUG){var r=e.map(br);vr.debug.apply(vr,(0,lr.pr)(["Firestore (8.2.9): "+t],r))}}function gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.ERROR){var r=e.map(br);vr.error.apply(vr,(0,lr.pr)(["Firestore (8.2.9): "+t],r))}}function wr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(vr.logLevel<=i.in.WARN){var r=e.map(br);vr.warn.apply(vr,(0,lr.pr)(["Firestore (8.2.9): "+t],r))}}function br(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function _r(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.9) INTERNAL ASSERTION FAILED: "+t;throw gr(e),new Error(e)}function Er(t,e){t||_r()}function Ir(t,e){return t}function Tr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Nr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Tr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Ar(t,e){return t<e?-1:t>e?1:0}function Sr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function xr(t){return t+"\0"}var Dr=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.h,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return Ar(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();Dr.T=new Dr("");var kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Or=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,lr.ZT)(e,t),e}(Error),Pr=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(Dr.fromBase64String(e))}catch(e){throw new Or(kr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Dr.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),Cr=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Cr.UNAUTHENTICATED=new Cr(null),Cr.R=new Cr("google-credentials-uid"),Cr.P=new Cr("first-party-uid");var Lr=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},Rr=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(Cr.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),Vr=function(){function t(t){var e=this;this.D=null,this.currentUser=Cr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then((function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.N!==e?(mr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Er("string"==typeof n.accessToken),new Lr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Er(null===t||"string"==typeof t),new Cr(t)},t}(),Mr=function(){function t(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=Cr.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ur=function(){function t(t,e){this.F=t,this.O=e}return t.prototype.getToken=function(){return Promise.resolve(new Mr(this.F,this.O))},t.prototype.v=function(t){t(Cr.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),Gr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}return t.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},t}();Gr.q=-1;var jr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?Ar(this.nanoseconds,t.nanoseconds):Ar(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Fr=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new jr(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),qr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),zr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.prototype.rt=function(){return this.it().join("/")},e.prototype.toString=function(){return this.rt()},e.ot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.ct=function(){return new e([])},e}(qr),Br=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.at=function(t){return Br.test(t)},e.prototype.rt=function(){return this.it().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.at(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.rt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.ht=function(){return new e(["__name__"])},e.lt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Or(kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Or(kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Or(kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.ct=function(){return new e([])},e}(qr),Hr=function(){function t(t){this.path=t}return t._t=function(e){return new t(zr.ot(e))},t.ft=function(e){return new t(zr.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===zr.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return zr.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new zr(e.slice()))},t}();function Qr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Yr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Xr=function(){function t(t){this.fields=t,t.sort(Jr.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return Sr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Zr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wr(t){if(Er(!!t),"string"==typeof t){var e=0,n=Zr.exec(t);if(Er(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$r(t.seconds),nanos:$r(t.nanos)}}function $r(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ti(t){return"string"==typeof t?Dr.fromBase64String(t):Dr.fromUint8Array(t)}function ei(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ni(t){var e=t.mapValue.fields.__previous_value__;return ei(e)?ni(e):e}function ri(t){var e=Wr(t.mapValue.fields.__local_write_time__.timestampValue);return new jr(e.seconds,e.nanos)}function ii(t){return null==t}function oi(t){return 0===t&&1/t==-1/0}function si(t){return"number"==typeof t&&Number.isInteger(t)&&!oi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ui(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ei(t)?4:10:_r()}function ai(t,e){var n=ui(t);if(n!==ui(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ri(t).isEqual(ri(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Wr(t.timestampValue),r=Wr(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ti(t.bytesValue).isEqual(ti(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return $r(t.geoPointValue.latitude)===$r(e.geoPointValue.latitude)&&$r(t.geoPointValue.longitude)===$r(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return $r(t.integerValue)===$r(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=$r(t.doubleValue),r=$r(e.doubleValue);return n===r?oi(n)===oi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Sr(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Qr(n)!==Qr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ai(n[i],r[i])))return!1;return!0}(t,e);default:return _r()}}function ci(t,e){return void 0!==(t.values||[]).find((function(t){return ai(t,e)}))}function hi(t,e){var n=ui(t),r=ui(e);if(n!==r)return Ar(n,r);switch(n){case 0:return 0;case 1:return Ar(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=$r(t.integerValue||t.doubleValue),r=$r(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return fi(t.timestampValue,e.timestampValue);case 4:return fi(ri(t),ri(e));case 5:return Ar(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ti(t),r=ti(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ar(n[i],r[i]);if(0!==o)return o}return Ar(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ar($r(t.latitude),$r(e.latitude));return 0!==n?n:Ar($r(t.longitude),$r(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=hi(n[i],r[i]);if(o)return o}return Ar(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ar(r[s],o[s]);if(0!==u)return u;var a=hi(n[r[s]],i[o[s]]);if(0!==a)return a}return Ar(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function fi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ar(t,e);var n=Wr(t),r=Wr(e),i=Ar(n.seconds,r.seconds);return 0!==i?i:Ar(n.nanos,r.nanos)}function li(t){return pi(t)}function pi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Wr(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ti(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Hr.ft(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=pi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+pi(t.fields[o])}return e+"}"}(t.mapValue):_r();var e,n}function di(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function vi(t){return!!t&&"integerValue"in t}function yi(t){return!!t&&"arrayValue"in t}function mi(t){return!!t&&"nullValue"in t}function gi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wi(t){return!!t&&"mapValue"in t}var bi=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!wi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return ai(this.proto,t.proto)},t}(),_i=function(){function t(t){void 0===t&&(t=bi.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ui(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(Jr.ct(),this.At);return null!=t?new bi(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=wi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.yt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Ei(t){var e=[];return Yr(t.fields||{},(function(t,n){var r=new Jr([t]);if(wi(n)){var i=Ei(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new Xr(e)}var Ii=function(t,e){this.key=t,this.version=e},Ti=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return(0,lr.ZT)(e,t),e.prototype.field=function(t){return this.gt.field(t)},e.prototype.data=function(){return this.gt},e.prototype.bt=function(){return this.gt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ii),Ni=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return(0,lr.ZT)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ii),Ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ii),Si=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function xi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Si(t,e,n,r,i,o,s)}function Di(t){var e=Ir(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.rt()+t.op.toString()+li(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.rt()+t.dir}(t)})).join(","),ii(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=qi(e.startAt)),e.endAt&&(n+="|ub:",n+=qi(e.endAt)),e.vt=n}return e.vt}function ki(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Bi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ai(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hi(t.startAt,e.startAt)&&Hi(t.endAt,e.endAt)}function Oi(t){return Hr.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Pi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,lr.ZT)(e,t),e.create=function(t,n,r){return t.ut()?"in"===n||"not-in"===n?this.St(t,n,r):new Ci(t,n,r):"array-contains"===n?new Mi(t,r):"in"===n?new Ui(t,r):"not-in"===n?new Gi(t,r):"array-contains-any"===n?new ji(t,r):new e(t,n,r)},e.St=function(t,e,n){return"in"===e?new Li(t,n):new Ri(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt(hi(e,this.value)):null!==e&&ui(this.value)===ui(e)&&this.Dt(hi(e,this.value))},e.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return _r()}},e.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ci=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Hr.ft(r.referenceValue),i}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){var e=Hr.H(t.key,this.key);return this.Dt(e)},e}(Pi),Li=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Vi(0,n),r}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Pi),Ri=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Vi(0,n),r}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Pi);function Vi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Hr.ft(t.referenceValue)}))}var Mi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return yi(e)&&ci(e.arrayValue,this.value)},e}(Pi),Ui=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ci(this.value.arrayValue,e)},e}(Pi),Gi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){if(ci(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ci(this.value.arrayValue,e)},e}(Pi),ji=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,lr.ZT)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!yi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ci(e.value.arrayValue,t)}))},e}(Pi),Fi=function(t,e){this.position=t,this.before=e};function qi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return li(t)})).join(",")}var zi=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Bi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ji(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ut()?Hr.H(Hr.ft(s.referenceValue),n.key):hi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Hi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ai(t.position[n],e.position[n]))return!1;return!0}var Qi=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Yi(t,e,n,r,i,o,s,u){return new Qi(t,e,n,r,i,o,s,u)}function Ki(t){return new Qi(t)}function Xi(t){return!ii(t.limit)&&"F"===t.limitType}function Zi(t){return!ii(t.limit)&&"L"===t.limitType}function Wi(t){return t.xt.length>0?t.xt[0].field:null}function $i(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function to(t){return null!==t.collectionGroup}function eo(t){var e=Ir(t);if(null===e.Nt){e.Nt=[];var n=$i(e),r=Wi(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new zi(n)),e.Nt.push(new zi(Jr.ht(),"asc"));else{for(var i=!1,o=0,s=e.xt;o<s.length;o++){var u=s[o];e.Nt.push(u),u.field.ut()&&(i=!0)}if(!i){var a=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new zi(Jr.ht(),a))}}}return e.Nt}function no(t){var e=Ir(t);if(!e.$t)if("F"===e.limitType)e.$t=xi(e.path,e.collectionGroup,eo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=eo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new zi(o.field,s))}var u=e.endAt?new Fi(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Fi(e.startAt.position,!e.startAt.before):null;e.$t=xi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.$t}function ro(t,e,n){return new Qi(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function io(t,e){return ki(no(t),no(e))&&t.limitType===e.limitType}function oo(t){return Di(no(t))+"|lt:"+t.limitType}function so(t){return"Query(target="+function(t){var e=t.path.rt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.rt()+" "+e.op+" "+li(e.value);var e})).join(", ")+"]"),ii(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.rt()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+qi(t.startAt)),t.endAt&&(e+=", endAt: "+qi(t.endAt)),"Target("+e+")"}(no(t))+"; limitType="+t.limitType+")"}function uo(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.dt(t.collectionGroup)&&t.path.nt(n):Hr.wt(t.path)?t.path.isEqual(n):t.path.st(n)}(t,e)&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ji(t.startAt,eo(t),e)||t.endAt&&Ji(t.endAt,eo(t),e))}(t,e)}function ao(t){return function(e,n){for(var r=!1,i=0,o=eo(t);i<o.length;i++){var s=o[i],u=co(s,e,n);if(0!==u)return u;r=r||s.field.ut()}return 0}}function co(t,e,n){var r=t.field.ut()?Hr.H(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?hi(r,i):_r()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _r()}}var ho=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Fr.min()),void 0===o&&(o=Fr.min()),void 0===s&&(s=Dr.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.kt=function(e){return new t(this.target,this.targetId,this.Ft,e,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Mt=function(e,n){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,e,this.resumeToken)},t}();function fo(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oi(e)?"-0":e}}function lo(t){return{integerValue:""+t}}function po(t,e){return si(e)?lo(e):fo(t,e)}var vo=function(){this.qt=void 0};function yo(t,e,n){return t instanceof wo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof bo?_o(t,e):t instanceof Eo?Io(t,e):function(t,e){var n=go(t,e),r=No(n)+No(t.Ut);return vi(n)&&vi(t.Ut)?lo(r):fo(t.Qt,r)}(t,e)}function mo(t,e,n){return t instanceof bo?_o(t,e):t instanceof Eo?Io(t,e):n}function go(t,e){return t instanceof To?vi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var wo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e}(vo),bo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,lr.ZT)(e,t),e}(vo);function _o(t,e){for(var n=Ao(e),r=function(t){n.some((function(e){return ai(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Eo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,lr.ZT)(e,t),e}(vo);function Io(t,e){for(var n=Ao(e),r=function(t){n=n.filter((function(e){return!ai(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var To=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return(0,lr.ZT)(e,t),e}(vo);function No(t){return $r(t.integerValue||t.doubleValue)}function Ao(t){return yi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var So=function(t,e){this.field=t,this.transform=e},xo=function(t,e){this.version=t,this.transformResults=e},Do=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ko(t,e){return void 0!==t.updateTime?e instanceof Ti&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ti}var Oo=function(){};function Po(t,e,n){return t instanceof Mo?function(t,e,n){var r=t.value;if(n.transformResults){var i=jo(t.fieldTransforms,e,n.transformResults);r=qo(t.fieldTransforms,r,i)}return new Ti(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Uo?function(t,e,n){if(!ko(t.jt,e))return new Ai(t.key,n.version);var r=Go(t,e,n.transformResults?jo(t.fieldTransforms,e,n.transformResults):[]);return new Ti(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Ni(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Co(t,e,n){return t instanceof Mo?function(t,e,n){if(!ko(t.jt,e))return e;var r=t.value,i=Fo(t.fieldTransforms,n,e);r=qo(t.fieldTransforms,r,i);var o=Vo(e);return new Ti(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof Uo?function(t,e,n){if(!ko(t.jt,e))return e;var r=Vo(e),i=Go(t,e,Fo(t.fieldTransforms,n,e));return new Ti(t.key,r,i,{Vt:!0})}(t,e,n):function(t,e){return ko(t.jt,e)?new Ni(t.key,Fr.min()):e}(t,e)}function Lo(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Ti?e.field(o.field):void 0,u=go(o.transform,s||null);null!=u&&(n=null==n?(new _i).set(o.field,u):n.set(o.field,u))}return n?n.Pt():null}(t.fieldTransforms,e)}function Ro(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Sr(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof bo&&e instanceof bo||t instanceof Eo&&e instanceof Eo?Sr(t.elements,e.elements,ai):t instanceof To&&e instanceof To?ai(t.Ut,e.Ut):t instanceof wo&&e instanceof wo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt))}function Vo(t){return t instanceof Ti?t.version:Fr.min()}var Mo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return(0,lr.ZT)(e,t),e}(Oo),Uo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.Gt=r,s.jt=i,s.fieldTransforms=o,s.type=1,s}return(0,lr.ZT)(e,t),e}(Oo);function Go(t,e,n){var r;return r=function(t,e){var n=new _i(e);return t.Gt.fields.forEach((function(e){if(!e.et()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Pt()}(t,r=e instanceof Ti?e.data():bi.empty()),qo(t.fieldTransforms,r,n)}function jo(t,e,n){var r=[];Er(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Ti&&(u=e.field(o.field)),r.push(mo(s,u,n[i]))}return r}function Fo(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],u=s.transform,a=null;n instanceof Ti&&(a=n.field(s.field)),r.push(yo(u,a,e))}return r}function qo(t,e,n){for(var r=new _i(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var zo,Bo,Jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return(0,lr.ZT)(e,t),e}(Oo),Ho=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return(0,lr.ZT)(e,t),e}(Oo),Qo=function(t){this.count=t};function Yo(t){switch(t){case kr.OK:return _r();case kr.CANCELLED:case kr.UNKNOWN:case kr.DEADLINE_EXCEEDED:case kr.RESOURCE_EXHAUSTED:case kr.INTERNAL:case kr.UNAVAILABLE:case kr.UNAUTHENTICATED:return!1;case kr.INVALID_ARGUMENT:case kr.NOT_FOUND:case kr.ALREADY_EXISTS:case kr.PERMISSION_DENIED:case kr.FAILED_PRECONDITION:case kr.ABORTED:case kr.OUT_OF_RANGE:case kr.UNIMPLEMENTED:case kr.DATA_LOSS:return!0;default:return _r()}}function Ko(t){if(void 0===t)return gr("GRPC error has no .code"),kr.UNKNOWN;switch(t){case zo.OK:return kr.OK;case zo.CANCELLED:return kr.CANCELLED;case zo.UNKNOWN:return kr.UNKNOWN;case zo.DEADLINE_EXCEEDED:return kr.DEADLINE_EXCEEDED;case zo.RESOURCE_EXHAUSTED:return kr.RESOURCE_EXHAUSTED;case zo.INTERNAL:return kr.INTERNAL;case zo.UNAVAILABLE:return kr.UNAVAILABLE;case zo.UNAUTHENTICATED:return kr.UNAUTHENTICATED;case zo.INVALID_ARGUMENT:return kr.INVALID_ARGUMENT;case zo.NOT_FOUND:return kr.NOT_FOUND;case zo.ALREADY_EXISTS:return kr.ALREADY_EXISTS;case zo.PERMISSION_DENIED:return kr.PERMISSION_DENIED;case zo.FAILED_PRECONDITION:return kr.FAILED_PRECONDITION;case zo.ABORTED:return kr.ABORTED;case zo.OUT_OF_RANGE:return kr.OUT_OF_RANGE;case zo.UNIMPLEMENTED:return kr.UNIMPLEMENTED;case zo.DATA_LOSS:return kr.DATA_LOSS;default:return _r()}}(Bo=zo||(zo={}))[Bo.OK=0]="OK",Bo[Bo.CANCELLED=1]="CANCELLED",Bo[Bo.UNKNOWN=2]="UNKNOWN",Bo[Bo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bo[Bo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bo[Bo.NOT_FOUND=5]="NOT_FOUND",Bo[Bo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bo[Bo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bo[Bo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bo[Bo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bo[Bo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bo[Bo.ABORTED=10]="ABORTED",Bo[Bo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bo[Bo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bo[Bo.INTERNAL=13]="INTERNAL",Bo[Bo.UNAVAILABLE=14]="UNAVAILABLE",Bo[Bo.DATA_LOSS=15]="DATA_LOSS";var Xo=function(){function t(t,e){this.H=t,this.root=e||Wo.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,Wo.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,Wo.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Xt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new Zo(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new Zo(this.root,t,this.H,!1)},t.prototype.ne=function(){return new Zo(this.root,null,this.H,!0)},t.prototype.se=function(t){return new Zo(this.root,t,this.H,!0)},t}(),Zo=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),Wo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw _r();if(this.right.le())throw _r();var t=this.left.Ie();if(t!==this.right.Ie())throw _r();return t+(this.le()?0:1)},t}();Wo.EMPTY=null,Wo.RED=!0,Wo.Ht=!1,Wo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new Wo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());var $o=function(){function t(t){this.H=t,this.data=new Xo(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt((function(e,n){return t(e),!1}))},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new ts(this.data.te())},t.prototype.ee=function(t){return new ts(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),ts=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),es=new Xo(Hr.H);function ns(){return es}function rs(){return ns()}var is=new Xo(Hr.H);function os(){return is}var ss=new Xo(Hr.H);function us(){return ss}var as=new $o(Hr.H);function cs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=as,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var hs=new $o(Ar);function fs(){return hs}var ls=function(){function t(t){this.H=t?function(e,n){return t(e,n)||Hr.H(e.key,n.key)}:function(t,e){return Hr.H(t.key,e.key)},this.ge=os(),this.Ve=new Xo(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),ps=function(){function t(){this.be=new Xo(Hr.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):_r():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt((function(e,n){t.push(n)})),t},t}(),ds=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}return t.Ne=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,ls.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&io(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),vs=function(){function t(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}return t.Me=function(e,n){var r=new Map;return r.set(e,ys.Le(e,n)),new t(Fr.min(),r,fs(),ns(),cs())},t}(),ys=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.Le=function(e,n){return new t(Dr.T,n,cs(),cs(),cs())},t}(),ms=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},gs=function(t,e){this.targetId=t,this.je=e},ws=function(t,e,n,r){void 0===n&&(n=Dr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bs=function(){function t(){this.Ge=0,this.ze=Is(),this.He=Dr.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=cs(),e=cs(),n=cs();return this.ze.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:_r()}})),new ys(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=Is()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),_s=function(){function t(t){this.un=t,this.hn=new Map,this.ln=ns(),this._n=Es(),this.fn=new $o(Ar)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Ti?this.wn(r,t.We):t.We instanceof Ni&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,(function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:_r()}}))},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach((function(t,r){n.An(r)&&e(r)}))},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(Oi(i))if(0===n){var o=new Hr(i.path);this.En(e,o,new Ni(o,Fr.min()))}else Er(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach((function(r,i){var o=e.yn(i);if(o){if(r.Be&&Oi(o.target)){var s=new Hr(o.target.path);null!==e.ln.get(s)||e.pn(i,s)||e.En(i,s,new Ni(s,t))}r.Ze&&(n.set(i,r.en()),r.nn())}}));var r=cs();this._n.forEach((function(t,n){var i=!0;n.Ae((function(t){var n=e.yn(t);return!n||2===n.Ft||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new vs(t,n,this.fn,this.ln,r);return this.ln=ns(),this._n=Es(),this.fn=new $o(Ar),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new bs,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new $o(Ar),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||mr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new bs),this.un.vn(t).forEach((function(n){e.En(t,n,null)}))},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();function Es(){return new Xo(Hr.H)}function Is(){return new Xo(Hr.H)}var Ts={asc:"ASCENDING",desc:"DESCENDING"},Ns={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},As=function(t,e){this.t=t,this.Bt=e};function Ss(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function xs(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Ds(t,e){return Ss(t,e.j())}function ks(t){return Er(!!t),Fr.K(function(t){var e=Wr(t);return new jr(e.seconds,e.nanos)}(t))}function Os(t,e){return function(t){return new zr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).rt()}function Ps(t){var e=zr.ot(t);return Er(nu(e)),e}function Cs(t,e){return Os(t.t,e.path)}function Ls(t,e){var n=Ps(e);if(n.get(1)!==t.t.projectId)throw new Or(kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Or(kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Hr(Us(n))}function Rs(t,e){return Os(t.t,e)}function Vs(t){var e=Ps(t);return 4===e.length?zr.ct():Us(e)}function Ms(t){return new zr(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Us(t){return Er(t.length>4&&"documents"===t.get(4)),t.Y(5)}function Gs(t,e,n){return{name:Cs(t,e),fields:n.proto.mapValue.fields}}function js(t,e,n){var r=Ls(t,e.name),i=ks(e.updateTime),o=new bi({mapValue:{fields:e.fields}});return new Ti(r,i,o,{hasCommittedMutations:!!n})}function Fs(t,e){var n;if(e instanceof Mo)n={update:Gs(t,e.key,e.value)};else if(e instanceof Jo)n={delete:Cs(t,e.key)};else if(e instanceof Uo)n={update:Gs(t,e.key,e.data),updateMask:eu(e.Gt)};else{if(!(e instanceof Ho))return _r();n={verify:Cs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof wo)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof bo)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof Eo)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof To)return{fieldPath:e.field.rt(),increment:n.Ut};throw _r()}(0,t)}))),e.jt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ds(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:_r()}(t,e.jt)),n}function qs(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Do.updateTime(ks(t.updateTime)):void 0!==t.exists?Do.exists(t.exists):Do.Kt()}(e.currentDocument):Do.Kt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Er("REQUEST_TIME"===e.setToServerValue),n=new wo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new bo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Eo(i)}else"increment"in e?n=new To(t,e.increment):_r();var o=Jr.lt(e.fieldPath);return new So(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Ls(t,e.update.name),o=new bi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Xr(e.map((function(t){return Jr.lt(t)})))}(e.updateMask);return new Uo(i,o,s,n,r)}return new Mo(i,o,n,r)}if(e.delete){var u=Ls(t,e.delete);return new Jo(u,n)}if(e.verify){var a=Ls(t,e.verify);return new Ho(a,n)}return _r()}function zs(t,e){return{documents:[Rs(t,e.path)]}}function Bs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Rs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Rs(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(gi(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NAN"}};if(mi(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(gi(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NOT_NAN"}};if(mi(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(t.field),op:Xs(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Zs(t.field),direction:Ks(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Bt||ii(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Qs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Qs(e.endAt)),n}function Js(t){var e=Vs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Er(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Hs(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new zi(Ws(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return ii(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ys(n.startAt));var h=null;return n.endAt&&(h=Ys(n.endAt)),Yi(e,i,u,s,a,"F",c,h)}function Hs(t){return t?void 0!==t.unaryFilter?[tu(t)]:void 0!==t.fieldFilter?[$s(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Hs(t)})).reduce((function(t,e){return t.concat(e)})):_r():[]}function Qs(t){return{before:t.before,values:t.position}}function Ys(t){var e=!!t.before,n=t.values||[];return new Fi(n,e)}function Ks(t){return Ts[t]}function Xs(t){return Ns[t]}function Zs(t){return{fieldPath:t.rt()}}function Ws(t){return Jr.lt(t.fieldPath)}function $s(t){return Pi.create(Ws(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(t.fieldFilter.op),t.fieldFilter.value)}function tu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ws(t.unaryFilter.field);return Pi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ws(t.unaryFilter.field);return Pi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ws(t.unaryFilter.field);return Pi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ws(t.unaryFilter.field);return Pi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}function eu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.rt())})),{fieldPaths:e}}function nu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ru=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},iu=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t((function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)}),(function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&_r(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(e,this.result):new t((function(t,i){r.Dn=function(n){r.Fn(e,n).next(t,i)},r.Cn=function(e){r.$n(n,e).next(t,i)}}))},t.prototype.On=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.kn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Fn=function(e,n){return e?this.kn((function(){return e(n)})):t.resolve(n)},t.prototype.$n=function(e,n){return e?this.kn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Mn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Ln=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Mn(r)},t}(),ou=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new ru,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new au(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=pu(e.target.error);n.Bn.reject(new au(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new au(n,e)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(mr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new hu(e)},t}(),su=function(){function t(e,n,r){this.name=e,this.version=n,this.Un=r,12.2===t.Qn((0,o.z$)())&&gr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return mr("SimpleDb","Removing database:",t),fu(window.indexedDB.deleteDatabase(t)).On()},t.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=(0,o.z$)(),n=t.Qn(e),r=0<n&&n<10,i=t.jn(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},t.zn=function(t,e){return t.store(e)},t.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Hn=function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(mr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new au(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Or(kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new au(t,n))},i.onupgradeneeded=function(t){mr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next((function(){mr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}}))}))},t.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a;return(0,lr.Jh)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return(0,lr.Jh)(this,(function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Hn(t)];case 2:return u.db=f.sent(),e=ou.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),iu.reject(t)})).On(),a={},s.catch((function(){})),[4,e.qn];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return c=f.sent(),h="FirebaseError"!==c.name&&o<3,mr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),uu=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return fu(this.Zn.delete())},t}(),au=function(t){function e(e,n){var r=this;return(r=t.call(this,kr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,lr.ZT)(e,t),e}(Or);function cu(t){return"IndexedDbTransactionError"===t.name}var hu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(mr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(mr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),fu(n)},t.prototype.add=function(t){return mr("SimpleDb","ADD",this.store.name,t,t),fu(this.store.add(t))},t.prototype.get=function(t){var e=this;return fu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),mr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return mr("SimpleDb","DELETE",this.store.name,t),fu(this.store.delete(t))},t.prototype.count=function(){return mr("SimpleDb","COUNT",this.store.name),fu(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.cs=function(t,e){mr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,(function(t,e,n){return n.delete()}))},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new iu((function(n,r){e.onerror=function(t){var e=pu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.os=function(t,e){var n=[];return new iu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new uu(i),s=e(i.primaryKey,i.value,o);if(s instanceof iu){var u=s.catch((function(t){return o.done(),iu.reject(t)}));n.push(u)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}})).next((function(){return iu.Mn(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function fu(t){return new iu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=pu(t.target.error);n(e)}}))}var lu=!1;function pu(t){var e=su.Qn((0,o.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Or("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return lu||(lu=!0,setTimeout((function(){throw r}),0)),r}}return t}var du=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new ru,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch((function(t){}))}return t.Ts=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Is=setTimeout((function(){return e.As()}),t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Or(kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps((function(){return null!==t.Is?(t.clearTimeout(),t.op().then((function(e){return t.Es.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function vu(t,e){if(gr("AsyncQueue",e+": "+t),cu(t))return new Or(kr.UNAVAILABLE,e+": "+t);throw t}var yu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",mu=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach((function(t){return t()}))},t}();function gu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=bu(e)),e=wu(t.get(n),e);return bu(e)}function wu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function bu(t){return t+""}function _u(t){var e=t.length;if(Er(e>=2),2===e)return Er(""===t.charAt(0)&&""===t.charAt(1)),zr.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&_r(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:_r()}o=s+2}return new zr(r)}var Eu=function(t,e){this.seconds=t,this.nanoseconds=e},Iu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Iu.store="owner",Iu.key="owner";var Tu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Tu.store="mutationQueues",Tu.keyPath="userId";var Nu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Nu.store="mutations",Nu.keyPath="batchId",Nu.userMutationsIndex="userMutationsIndex",Nu.userMutationsKeyPath=["userId","batchId"];var Au=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,gu(e)]},t.key=function(t,e,n){return[t,gu(e),n]},t}();Au.store="documentMutations",Au.PLACEHOLDER=new Au;var Su=function(t,e){this.path=t,this.readTime=e},xu=function(t,e){this.path=t,this.version=e},Du=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Du.store="remoteDocuments",Du.readTimeIndex="readTimeIndex",Du.readTimeIndexPath="readTime",Du.collectionReadTimeIndex="collectionReadTimeIndex",Du.collectionReadTimeIndexPath=["parentPath","readTime"];var ku=function(t){this.byteSize=t};ku.store="remoteDocumentGlobal",ku.key="remoteDocumentGlobalKey";var Ou=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ou.store="targets",Ou.keyPath="targetId",Ou.queryTargetsIndexName="queryTargetsIndex",Ou.queryTargetsKeyPath=["canonicalId","targetId"];var Pu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Pu.store="targetDocuments",Pu.keyPath=["targetId","path"],Pu.documentTargetsIndex="documentTargetsIndex",Pu.documentTargetsKeyPath=["path","targetId"];var Cu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Cu.key="targetGlobalKey",Cu.store="targetGlobal";var Lu=function(t,e){this.collectionId=t,this.parent=e};Lu.store="collectionParents",Lu.keyPath=["collectionId","parent"];var Ru=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ru.store="clientMetadata",Ru.keyPath="clientId";var Vu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Vu.store="bundles",Vu.keyPath="bundleId";var Mu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Mu.store="namedQueries",Mu.keyPath="name";var Uu=(0,lr.pr)((0,lr.pr)((0,lr.pr)((0,lr.pr)([Tu.store,Nu.store,Au.store,Du.store,Ou.store,Iu.store,Cu.store,Pu.store],[Ru.store]),[ku.store]),[Lu.store]),[Vu.store,Mu.store]),Gu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return(0,lr.ZT)(e,t),e}(mu);function ju(t,e){var n=Ir(t);return su.zn(n.ps,e)}var Fu=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Po(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=Co(s,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=Co(s,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),cs())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Sr(this.mutations,t.mutations,(function(t,e){return Ro(t,e)}))&&Sr(this.baseMutations,t.baseMutations,(function(t,e){return Ro(t,e)}))},t}(),qu=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}return t.from=function(e,n,r){Er(e.mutations.length===r.length);for(var i=us(),o=e.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),zu=function(t){this.Fs=t};function Bu(t,e){if(e.document)return js(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Hr.Et(e.noDocument.path),r=Ku(e.noDocument.readTime);return new Ni(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Hr.Et(e.unknownDocument.path);return r=Ku(e.unknownDocument.version),new Ai(i,r)}return _r()}function Ju(t,e,n){var r=Hu(n),i=e.key.path.X().it();if(e instanceof Ti){var o=function(t,e){return{name:Cs(t,e.key),fields:e.bt().mapValue.fields,updateTime:Ss(t,e.version.j())}}(t.Fs,e),s=e.hasCommittedMutations;return new Du(null,null,o,s,r,i)}if(e instanceof Ni){var u=e.key.path.it(),a=Yu(e.version);return s=e.hasCommittedMutations,new Du(null,new Su(u,a),null,s,r,i)}if(e instanceof Ai){var c=e.key.path.it(),h=Yu(e.version);return new Du(new xu(c,h),null,null,!0,r,i)}return _r()}function Hu(t){var e=t.j();return[e.seconds,e.nanoseconds]}function Qu(t){var e=new jr(t[0],t[1]);return Fr.K(e)}function Yu(t){var e=t.j();return new Eu(e.seconds,e.nanoseconds)}function Ku(t){var e=new jr(t.seconds,t.nanoseconds);return Fr.K(e)}function Xu(t,e){for(var n=(e.baseMutations||[]).map((function(e){return qs(t.Fs,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return qs(t.Fs,e)})),u=jr.fromMillis(e.localWriteTimeMs);return new Fu(e.batchId,u,n,s)}function Zu(t){var e,n,r=Ku(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ku(t.lastLimboFreeSnapshotVersion):Fr.min();return void 0!==t.query.documents?(Er(1===(n=t.query).documents.length),e=no(Ki(Vs(n.documents[0])))):e=function(t){return no(Js(t))}(t.query),new ho(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Dr.fromBase64String(t.resumeToken))}function Wu(t,e){var n,r=Yu(e.Ot),i=Yu(e.lastLimboFreeSnapshotVersion);n=Oi(e.target)?zs(t.Fs,e.target):Bs(t.Fs,e.target);var o=e.resumeToken.toBase64();return new Ou(e.targetId,Di(e.target),r,o,e.sequenceNumber,i,n)}function $u(t){var e=Js({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ro(e,e.limit,"L"):e}var ta=function(){function t(){}return t.prototype.Os=function(t,e){return ea(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Ku(e.createTime),version:e.version};var e}))},t.prototype.ks=function(t,e){return ea(t).put({bundleId:(n=e).id,createTime:Yu(ks(n.createTime)),version:n.version});var n},t.prototype.Ms=function(t,e){return na(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:$u(e.bundledQuery),readTime:Ku(e.readTime)};var e}))},t.prototype.Ls=function(t,e){return na(t).put(function(t){return{name:t.name,readTime:Yu(ks(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ea(t){return ju(t,Vu.store)}function na(t){return ju(t,Mu.store)}var ra=function(){function t(){this.Bs=new ia}return t.prototype.qs=function(t,e){return this.Bs.add(e),iu.resolve()},t.prototype.Us=function(t,e){return iu.resolve(this.Bs.getEntries(e))},t}(),ia=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new $o(zr.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new $o(zr.H)).it()},t}(),oa=function(){function t(){this.Qs=new ia}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs((function(){n.Qs.add(e)}));var o={collectionId:r,parent:gu(i)};return sa(t).put(o)}return iu.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[xr(e),""],!1,!0);return sa(t).rs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(_u(o.parent))}return n}))},t}();function sa(t){return ju(t,Lu.store)}var ua={Ks:!1,Ws:0,js:0,Gs:0},aa=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();function ca(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){if(t.code!==kr.FAILED_PRECONDITION||t.message!==yu)throw t;return mr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}aa.Xs=10,aa.Zs=1e3,aa.ti=new aa(41943040,aa.Xs,aa.Zs),aa.ei=new aa(-1,0,0);var ha=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.si(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Yr(this.ii,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.et=function(){return Kr(this.ii)},t}(),fa=function(){function t(){this.ri=new ha((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:Fr.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?iu.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();function la(t,e,n){var r=t.store(Nu.store),i=t.store(Au.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.hs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){Er(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Au.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return iu.Mn(o).next((function(){return c}))}function pa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _r();e=t.noDocument}return JSON.stringify(e).length}var da=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return Er(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ya(t).hs({index:Nu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ri=function(t,e,n,r){var i=this,o=ma(t),s=ya(t);return s.add({}).next((function(u){Er("number"==typeof u);for(var a=new Fu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Fs(t.Fs,e)})),i=n.mutations.map((function(e){return Fs(t.Fs,e)}));return new Nu(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,a),h=[],f=new $o((function(t,e){return Ar(t.rt(),e.rt())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Au.key(i.userId,d.key.path,u);f=f.add(d.key.path.X()),h.push(s.put(c)),h.push(o.put(v,Au.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ei.qs(t,e))})),t.gs((function(){i.Ii[u]=a.keys()})),iu.Mn(h).next((function(){return a}))}))},t.prototype.Pi=function(t,e){var n=this;return ya(t).get(e).next((function(t){return t?(Er(t.userId===n.userId),Xu(n.Qt,t)):null}))},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?iu.resolve(this.Ii[e]):this.Pi(t,e).next((function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null}))},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ya(t).hs({index:Nu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Er(e.batchId>=r),o=Xu(n.Qt,e)),i.done()})).next((function(){return o}))},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ya(t).hs({index:Nu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ya(t).rs(Nu.userMutationsIndex,n).next((function(t){return t.map((function(t){return Xu(e.Qt,t)}))}))},t.prototype.bi=function(t,e){var n=this,r=Au.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ma(t).hs({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=_u(a);if(u===n.userId&&e.path.isEqual(h))return ya(t).get(c).next((function(t){if(!t)throw _r();Er(t.userId===n.userId),o.push(Xu(n.Qt,t))}));s.done()})).next((function(){return o}))},t.prototype.vi=function(t,e){var n=this,r=new $o(Ar),i=[];return e.forEach((function(e){var o=Au.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=ma(t).hs({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=_u(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),iu.Mn(i).next((function(){return n.Si(t,r)}))},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=Au.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new $o(Ar);return ma(t).hs({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=_u(a);s===n.userId&&r.nt(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.Si(t,u)}))},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(ya(t).get(e).next((function(t){if(null===t)throw _r();Er(t.userId===n.userId),r.push(Xu(n.Qt,t))})))})),iu.Mn(i).next((function(){return r}))},t.prototype.Ci=function(t,e){var n=this;return la(t.ps,this.userId,e).next((function(r){return t.gs((function(){n.xi(e.batchId)})),iu.forEach(r,(function(e){return n.Ti.Ni(t,e)}))}))},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.$i=function(t){var e=this;return this.Ai(t).next((function(n){if(!n)return iu.resolve();var r=IDBKeyRange.lowerBound(Au.prefixForUser(e.userId)),i=[];return ma(t).hs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=_u(t[1]);i.push(o)}else r.done()})).next((function(){Er(0===i.length)}))}))},t.prototype.Fi=function(t,e){return va(t,this.userId,e)},t.prototype.Oi=function(t){var e=this;return ga(t).get(this.userId).next((function(t){return t||new Tu(e.userId,-1,"")}))},t}();function va(t,e,n){var r=Au.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ma(t).hs({range:o,us:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function ya(t){return ju(t,Nu.store)}function ma(t){return ju(t,Au.store)}function ga(t){return ju(t,Tu.store)}var wa=function(){function t(t){this.ki=t}return t.prototype.next=function(){return this.ki+=2,this.ki},t.Mi=function(){return new t(0)},t.Li=function(){return new t(-1)},t}(),ba=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next((function(n){var r=new wa(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Qi=function(t){return this.qi(t).next((function(t){return Fr.K(new jr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ki=function(t){return this.qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)}))},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next((function(){return n.qi(t).next((function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)}))}))},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next((function(){return _a(t).delete(e.targetId)})).next((function(){return n.qi(t)})).next((function(e){return Er(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)}))},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return _a(t).hs((function(s,u){var a=Zu(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Ji(t,a)))})).next((function(){return iu.Mn(o)})).next((function(){return i}))},t.prototype.In=function(t,e){return _a(t).hs((function(t,n){var r=Zu(n);e(r)}))},t.prototype.qi=function(t){return Ea(t).get(Cu.key).next((function(t){return Er(null!==t),t}))},t.prototype.Ui=function(t,e){return Ea(t).put(Cu.key,e)},t.prototype.Gi=function(t,e){return _a(t).put(Wu(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next((function(t){return t.targetCount}))},t.prototype.tr=function(t,e){var n=Di(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return _a(t).hs({range:r,index:Ou.queryTargetsIndexName},(function(t,n,r){var o=Zu(n);ki(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.er=function(t,e,n){var r=this,i=[],o=Ia(t);return e.forEach((function(e){var s=gu(e.path);i.push(o.put(new Pu(n,s))),i.push(r.Ti.nr(t,n,e))})),iu.Mn(i)},t.prototype.sr=function(t,e,n){var r=this,i=Ia(t);return iu.forEach(e,(function(e){var o=gu(e.path);return iu.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])}))},t.prototype.Yi=function(t,e){var n=Ia(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ia(t),i=cs();return r.hs({range:n,us:!0},(function(t,e,n){var r=_u(t[1]),o=new Hr(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fi=function(t,e){var n=gu(e.path),r=IDBKeyRange.bound([n],[xr(n)],!1,!0),i=0;return Ia(t).hs({index:Pu.documentTargetsIndex,us:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Sn=function(t,e){return _a(t).get(e).next((function(t){return t?Zu(t):null}))},t}();function _a(t){return ju(t,Ou.store)}function Ea(t){return ju(t,Cu.store)}function Ia(t){return ju(t,Pu.store)}function Ta(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ar(n,i);return 0===s?Ar(r,o):s}var Na=function(){function t(t){this.cr=t,this.buffer=new $o(Ta),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ta(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Aa=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;mr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,(function(){return(0,lr.mG)(e,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return cu(e=n.sent())?(mr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ca(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Sa=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Pr=function(t,e){var n=this;if(0===e)return iu.resolve(Gr.q);var r=new Na(e);return this.mr.In(t,(function(t){return r.hr(t.sequenceNumber)})).next((function(){return n.mr.yr(t,(function(t){return r.hr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(mr("LruGarbageCollector","Garbage collection skipped; disabled"),iu.resolve(ua)):this.pr(t).next((function(r){return r<n.params.zs?(mr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),ua):n.br(t,e)}))},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,r,o,s,u,a,c,h=this,f=Date.now();return this.Ar(t,this.params.Hs).next((function(e){return e>h.params.Js?(mr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+e),r=h.params.Js):r=e,s=Date.now(),h.Pr(t,r)})).next((function(r){return n=r,u=Date.now(),h.Xi(t,n,e)})).next((function(e){return o=e,a=Date.now(),h.gr(t,n)})).next((function(t){return c=Date.now(),yr()<=i.in.DEBUG&&mr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),iu.resolve({Ks:!0,Ws:r,js:o,Gs:t})}))},t}(),xa=function(){function t(t,e){this.db=t,this.lr=function(t,e){return new Sa(t,e)}(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.vr=function(t){var e=0;return this.yr(t,(function(t){e++})).next((function(){return e}))},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,(function(t,n){return e(n)}))},t.prototype.nr=function(t,e,n){return Da(t,n)},t.prototype.ir=function(t,e,n){return Da(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return Da(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return ga(t).ls((function(r){return va(t,r,e).next((function(t){return t&&(n=!0),iu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,(function(s,u){if(u<=e){var a=n.Cr(t,s).next((function(e){if(!e)return o++,r._i(t,s).next((function(){return r.li(s),Ia(t).delete([0,gu(s.path)])}))}));i.push(a)}})).next((function(){return iu.Mn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.kt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Fr=function(t,e){return Da(t,e)},t.prototype.Dr=function(t,e){var n,r=Ia(t),i=Gr.q;return r.hs({index:Pu.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Gr.q&&e(new Hr(_u(n)),i),i=u,n=s):i=Gr.q})).next((function(){i!==Gr.q&&e(new Hr(_u(n)),i)}))},t.prototype.pr=function(t){return this.db.$r().Or(t)},t}();function Da(t,e){return Ia(t).put(function(t,e){return new Pu(0,gu(t.path),e)}(e,t.bs))}var ka=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return Ca(t).put(La(e),n)},t.prototype.li=function(t,e){var n=Ca(t),r=La(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype._i=function(t,e){var n=this;return Ca(t).get(La(e)).next((function(t){return n.Mr(t)}))},t.prototype.Lr=function(t,e){var n=this;return Ca(t).get(La(e)).next((function(t){var e=n.Mr(t);return e?{hi:e,size:pa(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=rs();return this.Br(t,e,(function(t,e){var i=n.Mr(e);r=r.zt(t,i)})).next((function(){return r}))},t.prototype.qr=function(t,e){var n=this,r=rs(),i=new Xo(Hr.H);return this.Br(t,e,(function(t,e){var o=n.Mr(e);o?(r=r.zt(t,o),i=i.zt(t,pa(e))):(r=r.zt(t,null),i=i.zt(t,0))})).next((function(){return{Ur:r,Qr:i}}))},t.prototype.Br=function(t,e,n){if(e.et())return iu.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return Ca(t).hs({range:r},(function(t,e,r){for(var s=Hr.Et(t);o&&Hr.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ce()?i.oe():null}))},t.prototype.Kr=function(t,e,n){var r=this,i=os(),o=e.path.length+1,s={};if(n.isEqual(Fr.min())){var u=e.path.it();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.it(),c=Hu(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Du.collectionReadTimeIndex}return Ca(t).hs(s,(function(t,n,s){if(t.length===o){var u=Bu(r.Qt,n);e.path.nt(u.key.path)?u instanceof Ti&&uo(e,u)&&(i=i.zt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Nr=function(t){return new Oa(this,!!t&&t.Wr)},t.prototype.Or=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Pa(t).get(ku.key).next((function(t){return Er(!!t),t}))},t.prototype.kr=function(t,e){return Pa(t).put(ku.key,e)},t.prototype.Mr=function(t){if(t){var e=Bu(this.Qt,t);return e instanceof Ni&&e.version.isEqual(Fr.min())?null:e}return null},t}(),Oa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new ha((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,lr.ZT)(e,t),e.prototype.wi=function(t){var e=this,n=[],r=0,i=new $o((function(t,e){return Ar(t.rt(),e.rt())}));return this.ri.forEach((function(o,s){var u=e.Gr.get(o);if(s.hi){var a=Ju(e.jr.Qt,s.hi,e.ci(o));i=i.add(o.path.X());var c=pa(a);r+=c-u,n.push(e.jr.ai(t,o,a))}else if(r-=u,e.Wr){var h=Ju(e.jr.Qt,new Ni(o,Fr.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))})),i.forEach((function(r){n.push(e.jr.Ei.qs(t,r))})),n.push(this.jr.updateMetadata(t,r)),iu.Mn(n)},e.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next((function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)}))},e.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next((function(t){var e=t.Ur;return t.Qr.forEach((function(t,e){n.Gr.set(t,e)})),e}))},e}(fa);function Pa(t){return ju(t,ku.store)}function Ca(t){return ju(t,Du.store)}function La(t){return t.path.it()}var Ra=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;Er(n<r&&n>=0&&r<=11);var o=new ou("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Iu.store)}(t),function(t){t.createObjectStore(Tu.store,{keyPath:Tu.keyPath}),t.createObjectStore(Nu.store,{keyPath:Nu.keyPath,autoIncrement:!0}).createIndex(Nu.userMutationsIndex,Nu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Au.store)}(t),Va(t),function(t){t.createObjectStore(Du.store)}(t));var s=iu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Pu.store),t.deleteObjectStore(Ou.store),t.deleteObjectStore(Cu.store)}(t),Va(t)),s=s.next((function(){return function(t){var e=t.store(Cu.store),n=new Cu(0,0,Fr.min().j(),0);return e.put(Cu.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Nu.store).rs().next((function(n){t.deleteObjectStore(Nu.store),t.createObjectStore(Nu.store,{keyPath:Nu.keyPath,autoIncrement:!0}).createIndex(Nu.userMutationsIndex,Nu.userMutationsKeyPath,{unique:!0});var r=e.store(Nu.store),i=n.map((function(t){return r.put(t)}));return iu.Mn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ru.store,{keyPath:Ru.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.zr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ku.store)}(t),i.Hr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Jr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Yr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Du.store);e.createIndex(Du.readTimeIndex,Du.readTimeIndexPath,{unique:!1}),e.createIndex(Du.collectionReadTimeIndex,Du.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Xr(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Vu.store,{keyPath:Vu.keyPath})}(t),function(t){t.createObjectStore(Mu.store,{keyPath:Mu.keyPath})}(t)}))),s},t.prototype.Hr=function(t){var e=0;return t.store(Du.store).hs((function(t,n){e+=pa(n)})).next((function(){var n=new ku(e);return t.store(ku.store).put(ku.key,n)}))},t.prototype.zr=function(t){var e=this,n=t.store(Tu.store),r=t.store(Nu.store);return n.rs().next((function(n){return iu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(Nu.userMutationsIndex,i).next((function(r){return iu.forEach(r,(function(r){Er(r.userId===n.userId);var i=Xu(e.Qt,r);return la(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Jr=function(t){var e=t.store(Pu.store),n=t.store(Du.store);return t.store(Cu.store).get(Cu.key).next((function(t){var r=[];return n.hs((function(n,i){var o=new zr(n),s=function(t){return[0,gu(t)]}(o);r.push(e.get(s).next((function(n){return n?iu.resolve():function(n){return e.put(new Pu(0,gu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return iu.Mn(r)}))}))},t.prototype.Yr=function(t,e){t.createObjectStore(Lu.store,{keyPath:Lu.keyPath});var n=e.store(Lu.store),r=new ia,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:gu(i)})}};return e.store(Du.store).hs({us:!0},(function(t,e){var n=new zr(t);return i(n.X())})).next((function(){return e.store(Au.store).hs({us:!0},(function(t,e){t[0];var n=t[1],r=(t[2],_u(n));return i(r.X())}))}))},t.prototype.Xr=function(t){var e=this,n=t.store(Ou.store);return n.hs((function(t,r){var i=Zu(r),o=Wu(e.Qt,i);return n.put(o)}))},t}();function Va(t){t.createObjectStore(Pu.store,{keyPath:Pu.keyPath}).createIndex(Pu.documentTargetsIndex,Pu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ou.store,{keyPath:Ou.keyPath}).createIndex(Ou.queryTargetsIndexName,Ou.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Cu.store)}var Ma="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ua=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=u,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new Or(kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new xa(this,i),this.ho=n+"main",this.Qt=new zu(a),this.lo=new su(this.ho,11,new Ra(this.Qt)),this._o=new ba(this.Ti,this.Qt),this.Ei=new oa,this.fo=function(t,e){return new ka(t,e)}(this.Qt,this.Ei),this.wo=new ta,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&gr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Or(kr.FAILED_PRECONDITION,Ma);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t._o.Ki(e)}))})).then((function(e){t.so=new Gr(e,t.eo)})).then((function(){t.io=!0})).catch((function(e){return t.lo&&t.lo.close(),Promise.reject(e)}))},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return(0,lr.mG)(e,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){return this.Er?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn((function(n){return(0,lr.mG)(e,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps((function(){return(0,lr.mG)(e,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ja(e).put(new Ru(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Vo(e).next((function(e){e||(t.isPrimary=!1,t.Zr.po((function(){return t.uo(!1)})))}))})).next((function(){return t.bo(e)})).next((function(n){return t.isPrimary&&!n?t.vo(e).next((function(){return!1})):!!n&&t.So(e).next((function(){return!0}))}))})).catch((function(e){if(cu(e))return mr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return mr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Zr.po((function(){return t.uo(e)})),t.isPrimary=e}))},t.prototype.Vo=function(t){var e=this;return Ga(t).get(Iu.key).next((function(t){return iu.resolve(e.Do(t))}))},t.prototype.Co=function(t){return ja(t).delete(this.clientId)},t.prototype.xo=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=ju(t,Ru.store);return e.rs().next((function(t){var n=i.$o(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return iu.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,(function(){return t.To().then((function(){return t.xo()})).then((function(){return t.Ao()}))}))},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?iu.resolve(!0):Ga(t).get(Iu.key).next((function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new Or(kr.FAILED_PRECONDITION,Ma);return!1}}return!(!e.networkEnabled||!e.inForeground)||ja(t).rs().next((function(t){return void 0===e.$o(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&mr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ko=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t=this;return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Iu.store,Ru.store],(function(e){var n=new Gu(e,Gr.q);return t.vo(n).next((function(){return t.Co(n)}))}))];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}}))}))},t.prototype.$o=function(t,e){var n=this;return t.filter((function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)}))},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ja(e).rs().next((function(e){return t.$o(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return da.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;mr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,Uu,(function(o){return i=new Gu(o,r.so?r.so.next():Gr.q),"readwrite-primary"===e?r.Vo(i).next((function(t){return!!t||r.bo(i)})).next((function(e){if(!e)throw gr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po((function(){return r.uo(!1)})),new Or(kr.FAILED_PRECONDITION,yu);return n(i)})).next((function(t){return r.So(i).next((function(){return t}))})):r.jo(i).next((function(){return n(i)}))})).then((function(t){return i.Vs(),t}))},t.prototype.jo=function(t){var e=this;return Ga(t).get(Iu.key).next((function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Or(kr.FAILED_PRECONDITION,Ma)}))},t.prototype.So=function(t){var e=new Iu(this.clientId,this.allowTabSynchronization,Date.now());return Ga(t).put(Iu.key,e)},t.Kn=function(){return su.Kn()},t.prototype.vo=function(t){var e=this,n=Ga(t);return n.get(Iu.key).next((function(t){return e.Do(t)?(mr("IndexedDbPersistence","Releasing primary lease."),n.delete(Iu.key)):iu.resolve()}))},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(gr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps((function(){return t.inForeground="visible"===t.document.visibilityState,t.To()}))},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps((function(){return e.ko()}))},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.Oo=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return mr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return gr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){gr("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},t.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Ga(t){return ju(t,Iu.store)}function ja(t){return ju(t,Ru.store)}function Fa(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var qa=function(t,e){this.progress=t,this.Go=e},za=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next((function(r){return n.Jo(t,e,r)}))},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t}))},t.prototype.Yo=function(t,e,n){var r=rs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)})),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next((function(e){return n.Zo(t,e)}))},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next((function(r){var i=n.Yo(t,e,r),o=ns();return i.forEach((function(t,e){e||(e=new Ni(t,Fr.min())),o=o.zt(t,e)})),o}))},t.prototype.Kr=function(t,e,n){return function(t){return Hr.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.tc(t,e.path):to(e)?this.ec(t,e,n):this.nc(t,e,n)},t.prototype.tc=function(t,e){return this.Ho(t,new Hr(e)).next((function(t){var e=os();return t instanceof Ti&&(e=e.zt(t.key,t)),e}))},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=os();return this.Ei.Us(t,i).next((function(s){return iu.forEach(s,(function(s){var u=function(t,e){return new Qi(e,null,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.nc(t,u,n).next((function(t){t.forEach((function(t,e){o=o.zt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next((function(n){return r=n,o.zo.Di(t,e)})).next((function(e){return i=e,o.sc(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=Co(a,r.get(c),o.vs);r=h instanceof Ti?r.zt(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){uo(e,n)||(r=r.remove(t))})),r}))},t.prototype.sc=function(t,e,n){for(var r=cs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Uo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Ti&&(c=c.zt(t,e))})),c}))},t}(),Ba=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=cs(),i=cs(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ja=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,r){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.xt.length||1===t.xt.length&&t.xt[0].field.ut())}(e)||n.isEqual(Fr.min())?this.uc(t,e):this.ac.Xo(t,r).next((function(s){var u=o.hc(e,s);return(Xi(e)||Zi(e))&&o.lc(e.limitType,u,r,n)?o.uc(t,e):(yr()<=i.in.DEBUG&&mr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),so(e)),o.ac.Kr(t,e,n).next((function(t){return u.forEach((function(e){t=t.zt(e.key,e)})),t})))}))},t.prototype.hc=function(t,e){var n=new $o(ao(t));return e.forEach((function(e,r){r instanceof Ti&&uo(t,r)&&(n=n.add(r))})),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return yr()<=i.in.DEBUG&&mr("QueryEngine","Using full collection scan to execute query:",so(e)),this.ac.Kr(t,e,Fr.min())},t}(),Ha=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Xo(Ar),this.dc=new ha((function(t){return Di(t)}),ki),this.wc=Fr.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new za(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Vr(n,e.fc)}))},t}();function Qa(t,e,n,r){return new Ha(t,e,n,r)}function Ya(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,lr.Jh)(this,(function(s){switch(s.label){case 0:return n=Ir(t),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.zo.pi(t).next((function(s){return o=s,r=n.persistence.Qo(e),i=new za(n.Ec,r,n.persistence.Ko()),r.pi(t)})).next((function(e){for(var n=[],r=[],s=cs(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];s=s.add(g.key)}}return i.Xo(t,s).next((function(t){return{Ic:t,mc:n,Ac:r}}))}))}))];case 1:return o=s.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}}))}))}function Ka(t,e){var n=Ir(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ec.Nr({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=iu.resolve();return o.forEach((function(t){s=s.next((function(){return r._i(e,t)})).next((function(e){var o=e,s=n.$s.get(t);Er(null!==s),(!o||o.version._(s)<0)&&(o=i.Ss(t,o,n))&&r.ai(o,n.Ns)}))})),s.next((function(){return t.zo.Ci(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}function Xa(t){var e=Ir(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e._o.Qi(t)}))}function Za(t,e){var n=Ir(t),r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.$e.forEach((function(e,o){var u=i.get(o);if(u){s.push(n._o.sr(t,e.Qe,o).next((function(){return n._o.er(t,e.qe,o)})));var a=e.resumeToken;if(a.l()>0){var c=u.Mt(a,r).kt(t.bs);i=i.zt(o,c),function(t,e,n){return Er(e.resumeToken.l()>0),0===t.resumeToken.l()||e.Ot.W()-t.Ot.W()>=3e8||n.qe.size+n.Ue.size+n.Qe.size>0}(u,c,e)&&s.push(n._o.Hi(t,c))}}}));var u=ns();if(e.Oe.forEach((function(r,i){e.ke.has(r)&&s.push(n.persistence.Ti.Fr(t,r))})),s.push(Wa(t,o,e.Oe,r,void 0).next((function(t){u=t}))),!r.isEqual(Fr.min())){var a=n._o.Qi(t).next((function(e){return n._o.Wi(t,t.bs,r)}));s.push(a)}return iu.Mn(s).next((function(){return o.apply(t)})).next((function(){return n.Tc.Zo(t,u)}))})).then((function(t){return n.fc=i,t}))}function Wa(t,e,n,r,i){var o=cs();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=ns();return n.forEach((function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Ni&&s.version.isEqual(Fr.min())?(e.li(n,a),o=o.zt(n,s)):null==u||s.version._(u.version)>0||0===s.version._(u.version)&&u.hasPendingWrites?(e.ai(s,a),o=o.zt(n,s)):mr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)})),o}))}function $a(t,e){var n=Ir(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)}))}function tc(t,e){var n=Ir(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n._o.tr(t,e).next((function(i){return i?(r=i,iu.resolve(r)):n._o.Bi(t).next((function(i){return r=new ho(e,i,0,t.bs),n._o.ji(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.fc.get(t.targetId);return(null===r||t.Ot._(r.Ot)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t}))}function ec(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:r=Ir(t),i=r.fc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Ti.removeTarget(t,i)}))];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!cu(s=u.sent()))throw s;return mr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}}))}))}function nc(t,e,n){var r=Ir(t),i=Fr.min(),o=cs();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Ir(t),i=r.dc.get(n);return void 0!==i?iu.resolve(r.fc.get(i)):r._o.tr(e,n)}(r,t,no(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r._c.Kr(t,e,n?i:Fr.min(),n?o:cs())})).next((function(t){return{documents:t,Rc:o}}))}))}function rc(t,e){var n=Ir(t),r=Ir(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Sn(t,e).next((function(t){return t?t.target:null}))}))}function ic(t){var e=Ir(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Ir(t),i=ns(),o=Hu(n),s=Ca(e),u=IDBKeyRange.lowerBound(o,!0);return s.hs({index:Du.readTimeIndex,range:u},(function(t,e){var n=Bu(r.Qt,e);i=i.zt(n.key,n),o=e.readTime})).next((function(){return{Go:i,readTime:Qu(o)}}))}(e.Ec,t,e.wc)})).then((function(t){var n=t.Go,r=t.readTime;return e.wc=r,n}))}function oc(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){return[2,(e=Ir(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Ca(t),n=Fr.min();return e.hs({index:Du.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Qu(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.wc=t}))]}))}))}function sc(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a,c,h,f,l,p;return(0,lr.Jh)(this,(function(d){switch(d.label){case 0:for(i=Ir(t),o=cs(),s=ns(),u=us(),a=0,c=n;a<c.length;a++)h=c[a],f=e.Pc(h.metadata.name),h.document&&(o=o.add(f)),s=s.zt(f,e.yc(h)),u=u.zt(f,e.gc(h.metadata.readTime));return l=i.Ec.Nr({Wr:!0}),[4,tc(i,function(t){return no(Ki(zr.ot("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Wa(t,l,s,Fr.min(),u).next((function(e){return l.apply(t),e})).next((function(e){return i._o.Yi(t,p.targetId).next((function(){return i._o.er(t,o,p.targetId)})).next((function(){return i.Tc.Zo(t,e)}))}))}))]}}))}))}function uc(t,e,n){return void 0===n&&(n=cs()),(0,lr.mG)(this,void 0,void 0,(function(){var r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return[4,tc(t,no($u(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Ir(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=ks(e.readTime);if(r.Ot._(o)>=0)return i.wo.Ls(t,e);var s=r.Mt(Dr.T,o);return i.fc=i.fc.zt(s.targetId,s),i._o.Hi(t,s).next((function(){return i._o.Yi(t,r.targetId)})).next((function(){return i._o.er(t,n,r.targetId)})).next((function(){return i.wo.Ls(t,e)}))}))]}}))}))}var ac=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.Os=function(t,e){return iu.resolve(this.Vc.get(e))},t.prototype.ks=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:ks(n.createTime)}),iu.resolve()},t.prototype.Ms=function(t,e){return iu.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){return this.bc.set(e.name,function(t){return{name:t.name,query:$u(t.bundledQuery),readTime:ks(t.readTime)}}(e)),iu.resolve()},t}(),cc=function(){function t(){this.vc=new $o(hc.Sc),this.Dc=new $o(hc.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new hc(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach((function(t){return n.nr(t,e)}))},t.prototype.ir=function(t,e){this.Nc(new hc(t,e))},t.prototype.$c=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.Fc=function(t){var e=this,n=new Hr(new zr([])),r=new hc(n,t),i=new hc(n,t+1),o=[];return this.Dc.me([r,i],(function(t){e.Nc(t),o.push(t.key)})),o},t.prototype.Oc=function(){var t=this;this.vc.forEach((function(e){return t.Nc(e)}))},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.kc=function(t){var e=new Hr(new zr([])),n=new hc(e,t),r=new hc(e,t+1),i=cs();return this.Dc.me([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fi=function(t){var e=new hc(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),hc=function(){function t(t,e){this.key=t,this.Mc=e}return t.Sc=function(t,e){return Hr.H(t.key,e.key)||Ar(t.Mc,e.Mc)},t.Cc=function(t,e){return Ar(t.Mc,e.Mc)||Hr.H(t.key,e.key)},t}(),fc=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new $o(hc.Sc)}return t.prototype.Ai=function(t){return iu.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var o=new Fu(i,e,n,r);this.zo.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Bc=this.Bc.add(new hc(a.key,i)),this.Ei.qs(t,a.key.path.X())}return iu.resolve(o)},t.prototype.Pi=function(t,e){return iu.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=e+1,r=this.Uc(n),i=r<0?0:r;return iu.resolve(this.zo.length>i?this.zo[i]:null)},t.prototype.Vi=function(){return iu.resolve(0===this.zo.length?-1:this.Lc-1)},t.prototype.pi=function(t){return iu.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new hc(e,0),i=new hc(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],(function(t){var e=n.qc(t.Mc);o.push(e)})),iu.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new $o(Ar);return e.forEach((function(t){var e=new hc(t,0),i=new hc(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],(function(t){r=r.add(t.Mc)}))})),iu.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;Hr.wt(i)||(i=i.child(""));var o=new hc(new Hr(i),0),s=new $o(Ar);return this.Bc.Ae((function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(s=s.add(t.Mc)),!0)}),o),iu.resolve(this.Qc(s))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.qc(t);null!==r&&n.push(r)})),n},t.prototype.Ci=function(t,e){var n=this;Er(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return iu.forEach(e.mutations,(function(i){var o=new hc(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)})).next((function(){n.Bc=r}))},t.prototype.xi=function(t){},t.prototype.Fi=function(t,e){var n=new hc(e,0),r=this.Bc.Re(n);return iu.resolve(e.isEqual(r&&r.key))},t.prototype.$i=function(t){return this.zo.length,iu.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),lc=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new Xo(Hr.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:s,readTime:n}),this.size+=s-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return iu.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=rs();return e.forEach((function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)})),iu.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=os(),i=new Hr(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),u=s.key,a=s.value,c=a.hi,h=a.readTime;if(!e.path.nt(u.path))break;h._(n)<=0||c instanceof Ti&&uo(e,c)&&(r=r.zt(c.key,c))}return iu.resolve(r)},t.prototype.jc=function(t,e){return iu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Nr=function(t){return new pc(this)},t.prototype.Or=function(t){return iu.resolve(this.size)},t}(),pc=function(t){function e(e){var n=this;return(n=t.call(this)||this).jr=e,n}return(0,lr.ZT)(e,t),e.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach((function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)})),iu.Mn(n)},e.prototype.fi=function(t,e){return this.jr._i(t,e)},e.prototype.di=function(t,e){return this.jr.getEntries(t,e)},e}(fa),dc=function(){function t(t){this.persistence=t,this.Gc=new ha((function(t){return Di(t)}),ki),this.lastRemoteSnapshotVersion=Fr.min(),this.highestTargetId=0,this.zc=0,this.Hc=new cc,this.targetCount=0,this.Jc=wa.Mi()}return t.prototype.In=function(t,e){return this.Gc.forEach((function(t,n){return e(n)})),iu.resolve()},t.prototype.Qi=function(t){return iu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return iu.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),iu.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),iu.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new wa(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,iu.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),iu.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),this.targetCount-=1,iu.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,u.targetId)),i++)})),iu.Mn(o).next((function(){return i}))},t.prototype.Zi=function(t){return iu.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return iu.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),iu.resolve()},t.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach((function(e){i.push(r.Ni(t,e))})),iu.Mn(i)},t.prototype.Yi=function(t,e){return this.Hc.Fc(e),iu.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.kc(e);return iu.resolve(n)},t.prototype.Fi=function(t,e){return iu.resolve(this.Hc.Fi(e))},t}(),vc=function(){function t(t,e){var n=this;this.Yc={},this.so=new Gr(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new dc(this),this.Ei=new ra,this.fo=function(t,e){return new lc(t,(function(t){return n.Ti.Xc(t)}))}(this.Ei),this.Qt=new zu(e),this.wo=new ac(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new fc(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;mr("MemoryPersistence","Starting transaction:",t);var i=new yc(this.so.next());return this.Ti.Zc(),n(i).next((function(t){return r.Ti.ta(i).next((function(){return t}))})).On().then((function(t){return i.Vs(),t}))},t.prototype.ea=function(t,e){return iu.Ln(Object.values(this.Yc).map((function(n){return function(){return n.Fi(t,e)}})))},t}(),yc=function(t){function e(e){var n=this;return(n=t.call(this)||this).bs=e,n}return(0,lr.ZT)(e,t),e}(mu),mc=function(){function t(t){this.persistence=t,this.na=new cc,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw _r()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),iu.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),iu.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),iu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach((function(t){return n.ra.add(t.toString())}));var r=this.persistence.Sr();return r.rr(t,e.targetId).next((function(t){t.forEach((function(t){return n.ra.add(t.toString())}))})).next((function(){return r.Ji(t,e)}))},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return iu.forEach(this.ra,(function(r){var i=Hr._t(r);return e.oa(t,i).next((function(t){t||n.li(i)}))})).next((function(){return e.sa=null,n.apply(t)}))},t.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next((function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())}))},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return iu.Ln([function(){return iu.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();function gc(t,e){return"firestore_clients_"+t+"_"+e}function wc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function bc(t,e){return"firestore_targets_"+t+"_"+e}var _c=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Or(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(gr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ec=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Or(i.error.code,i.error.message)),o?new t(e,i.state,r):(gr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ic=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=fs(),s=0;i&&s<r.activeTargetIds.length;++s)i=si(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(gr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Tc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(gr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Nc=function(){function t(){this.activeTargetIds=fs()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ac=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Xo(Ar),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=gc(this.persistenceKey,this.la),this.ma=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new Nc),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,a,c,h,f=this;return(0,lr.Jh)(this,(function(l){switch(l.label){case 0:return[4,this._a.Uo()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(gc(this.persistenceKey,r)))&&(o=Ic.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(s=this.storage.getItem(this.ya))&&(u=this.pa(s))&&this.ba(u),a=0,c=this.Ta;a<c.length;a++)h=c[a],this.wa(h);return this.Ta=[],this.window.addEventListener("unload",(function(){return f.ko()})),this.Er=!0,[2]}}))}))},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},t.prototype.Fa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(bc(this.persistenceKey,t));if(n){var r=Ec.ca(t,n);r&&(e=r.state)}}return this.Oa.ua(t),this.Va(),e},t.prototype.ka=function(t){this.Oa.ha(t),this.Va()},t.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},t.prototype.La=function(t){this.removeItem(bc(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach((function(t){r.$a(t)})),this.currentUser=t,n.forEach((function(t){r.Ca(t)}))},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return mr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){mr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){mr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(mr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void gr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po((function(){return(0,lr.mG)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return(0,lr.Jh)(this,(function(u){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(i=this.Xa(n.key,n.newValue)))return[2,this.Za(i)]}else if(n.key===this.ya){if(null!==n.newValue&&(o=this.pa(n.newValue)))return[2,this.ba(o)]}else if(n.key===this.ma)(s=function(t){var e=Gr.q;if(null!=t)try{var n=JSON.parse(t);Er("number"==typeof n),e=n}catch(t){gr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Gr.q&&this.k(s);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},t.prototype.xa=function(t,e,n){var r=new _c(this.currentUser,t,e,n),i=wc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.$a=function(t){var e=wc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){var e={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(e))},t.prototype.qa=function(t,e,n){var r=bc(this.persistenceKey,t),i=new Ec(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return Ic.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return _c.ca(new Cr(i),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Ec.ca(r,e)},t.prototype.pa=function(t){return Tc.ca(t)},t.prototype.Ya=function(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(mr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this._a.su(s,u).then((function(){n.Ea=r}))},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=fs();return t.forEach((function(t,n){e=e.Pe(n.activeTargetIds)})),e},t}(),Sc=function(){function t(){this.iu=new Nc,this.ru={},this.fa=null,this.k=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.ka=function(t){this.iu.ha(t)},t.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.La=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new Nc,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.ko=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),xc=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.ko=function(){},t}(),Dc=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){mr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){mr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),kc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Oc=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),Pc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return(0,lr.ZT)(e,t),e.prototype.Su=function(t,e,n,r){return new Promise((function(i,o){var s=new fr;s.listenOnce(sr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case or.NO_ERROR:var e=s.getResponseJson();mr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case or.TIMEOUT:mr("Connection",'RPC "'+t+'" timed out'),o(new Or(kr.DEADLINE_EXCEEDED,"Request time out"));break;case or.HTTP_ERROR:var n=s.getStatus();if(mr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(kr).indexOf(e)>=0?e:kr.UNKNOWN}(r.status);o(new Or(u,r.message))}else o(new Or(kr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Or(kr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{mr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.Cu=function(t,e){var n=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new tr,i=ee(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(s.initMessageHeaders,e),(0,o.uI)()||(0,o.b$)()||(0,o.d)()||(0,o.w1)()||(0,o.Mn)()||(0,o.ru)()||(s.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");mr("Connection","Creating WebChannel: "+u,s);var a=r.createWebChannel(u,s),c=!1,h=!1,f=new Oc({fu:function(t){h?mr("Connection","Not sending because WebChannel is closed:",t):(c||(mr("Connection","Opening WebChannel transport."),a.open(),c=!0),mr("Connection","WebChannel sending:",t),a.send(t))},du:function(){return a.close()}}),l=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(a,hr.EventType.OPEN,(function(){h||mr("Connection","WebChannel transport opened.")})),l(a,hr.EventType.CLOSE,(function(){h||(h=!0,mr("Connection","WebChannel transport closed"),f.Ru())})),l(a,hr.EventType.ERROR,(function(t){h||(h=!0,wr("Connection","WebChannel transport errored:",t),f.Ru(new Or(kr.UNAVAILABLE,"The operation could not be completed")))})),l(a,hr.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Er(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){mr("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=zo[t];if(void 0!==e)return Ko(e)}(o),u=i.message;void 0===s&&(s=kr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,f.Ru(new Or(s,u)),a.close()}else mr("Connection","WebChannel received:",n),f.Pu(n)}})),l(i,ur.STAT_EVENT,(function(t){t.stat===ar?mr("Connection","Detected buffering proxy"):t.stat===cr&&mr("Connection","Detected no buffering proxy")})),setTimeout((function(){f.Au()}),0),f},e}(function(){function t(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);mr("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then((function(t){return mr("RestConnection","Received: ",t),t}),(function(e){throw wr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.9",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){var n=kc[t];return this.gu+"/v1/"+e+":"+n},t}());function Cc(){return"undefined"!=typeof window?window:null}function Lc(){return"undefined"!=typeof document?document:null}function Rc(t){return new As(t,!0)}var Vc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return t.prototype.reset=function(){this.Fu=0},t.prototype.Mu=function(){this.Fu=this.$u},t.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);i>0&&mr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,(function(){return e.ku=Date.now(),t()})),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},t.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},t.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},t}(),Mc=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Vc(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,(function(){return t.Zu()})))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){return this.Hu()?[2,this.close(0)]:[2]}))}))},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===kr.RESOURCE_EXHAUSTED?(gr(e.toString()),gr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===kr.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then((function(e){t.Wu===n&&t.ih(e)}),(function(n){e((function(){var e=new Or(kr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)}))}))},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu((function(){n((function(){return e.state=2,e.listener.wu()}))})),this.stream.Tu((function(t){n((function(){return e.rh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu((function(){return(0,lr.mG)(t,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.rh=function(t){return mr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps((function(){return e.Wu===t?n():(mr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Uc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,s}return(0,lr.ZT)(e,t),e.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},e.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:_r()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Bt?(Er(void 0===e||"string"==typeof e),Dr.fromBase64String(e||"")):(Er(void 0===e||e instanceof Uint8Array),Dr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?kr.UNKNOWN:Ko(t.code);return new Or(e,t.message||"")}(u);n=new ws(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Ls(t,r.document.name),o=ks(r.document.updateTime);var u=new bi({mapValue:{fields:r.document.fields}}),a=(s=new Ti(i,o,u,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new ms(a,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Ls(t,r.document),o=r.readTime?ks(r.readTime):Fr.min(),u=new Ni(i,o),s=r.removedTargetIds||[],n=new ms([],s,u.key,u);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Ls(t,r.document),o=r.removedTargetIds||[],n=new ms([],o,i,null);else{if(!("filter"in e))return _r();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Qo(r),o=h.targetId,n=new gs(o,i)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return Fr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Fr.min():e.readTime?ks(e.readTime):Fr.min()}(t);return this.listener.ah(e,n)},e.prototype.uh=function(t){var e={};e.database=Ms(this.Qt),e.addTarget=function(t,e){var n,r=e.target;return(n=Oi(r)?{documents:zs(t,r)}:{query:Bs(t,r)}).targetId=e.targetId,e.resumeToken.l()>0?n.resumeToken=xs(t,e.resumeToken):e.Ot._(Fr.min())>0&&(n.readTime=Ss(t,e.Ot.j())),n}(this.Qt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}(0,e.Ft);return null==n?null:{"goog-listen-tags":n}}(this.Qt,t);n&&(e.labels=n),this.th(e)},e.prototype.hh=function(t){var e={};e.database=Ms(this.Qt),e.removeTarget=t,this.th(e)},e}(Mc),Gc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,s.lh=!1,s}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.nh=function(){this.lh&&this.fh([])},e.prototype.oh=function(t){return this.Qu.Cu("Write",t)},e.prototype.onMessage=function(t){if(Er(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=function(t,e){return t&&t.length>0?(Er(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ks(t.updateTime):ks(e);n.isEqual(Fr.min())&&(n=ks(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new xo(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ks(t.commitTime);return this.listener.dh(n,e)}return Er(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},e.prototype.Eh=function(){var t={};t.database=Ms(this.Qt),this.th(t)},e.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Fs(e.Qt,t)}))};this.th(n)},e}(Mc),jc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return(0,lr.ZT)(e,t),e.prototype.Ih=function(){if(this.Th)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.pu(t,e,n,i)})).catch((function(t){throw t.code===kr.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.Du(t,e,n,i)})).catch((function(t){throw t.code===kr.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.terminate=function(){this.Th=!1},e}((function(){})),Fc=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,(function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()})))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(gr(e),this.Rh=!1):mr("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),qc=function(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou((function(t){n.Ps((function(){return(0,lr.mG)(o,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return Zc(this)?(mr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Ir(t)).Nh.add(4),[4,Bc(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,zc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Oh=new Fc(n,r)};function zc(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:if(!Zc(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Bc(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Jc(t,e){var n=Ir(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),Xc(n)?Kc(n):lh(n).Hu()&&Qc(n,e))}function Hc(t,e){var n=Ir(t),r=lh(n);n.xh.delete(e),r.Hu()&&Yc(n,e),0===n.xh.size&&(r.Hu()?r.Xu():Zc(n)&&n.Oh.set("Unknown"))}function Qc(t,e){t.kh.on(e.targetId),lh(t).uh(e)}function Yc(t,e){t.kh.on(e),lh(t).hh(e)}function Kc(t){t.kh=new _s({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),lh(t).start(),t.Oh.Ph()}function Xc(t){return Zc(t)&&!lh(t).zu()&&t.xh.size>0}function Zc(t){return 0===Ir(t).Nh.size}function Wc(t){t.kh=void 0}function $c(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){return t.xh.forEach((function(e,n){Qc(t,e)})),[2]}))}))}function th(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(n){return Wc(t),Xc(t)?(t.Oh.Vh(e),Kc(t)):t.Oh.set("Unknown"),[2]}))}))}function eh(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,lr.Jh)(this,(function(s){switch(s.label){case 0:if(t.Oh.set("Online"),!(e instanceof ws&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,lr.Jh)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.xh.has(o)?[4,t.Dh.Mh(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.xh.delete(o),t.kh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),mr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,nh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof ms?t.kh.dn(e):e instanceof gs?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(Fr.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Xa(t.bh)];case 8:return i=s.sent(),n._(i)>=0?[4,function(t,e){var n=t.kh.Vn(e);return n.$e.forEach((function(n,r){if(n.resumeToken.l()>0){var i=t.xh.get(r);i&&t.xh.set(r,i.Mt(n.resumeToken,e))}})),n.Fe.forEach((function(e){var n=t.xh.get(e);if(n){t.xh.set(e,n.Mt(Dr.T,n.Ot)),Yc(t,e);var r=new ho(n.target,e,1,n.sequenceNumber);Qc(t,r)}})),t.Dh.Lh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return mr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,nh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function nh(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r=this;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:if(!cu(e))throw e;return t.Nh.add(1),[4,Bc(t)];case 1:return i.sent(),t.Oh.set("Offline"),n||(n=function(){return Xa(t.bh)}),t._s.po((function(){return(0,lr.mG)(r,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return mr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,zc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function rh(t,e){return e().catch((function(n){return nh(t,n,e)}))}function ih(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,lr.Jh)(this,(function(s){switch(s.label){case 0:e=Ir(t),n=ph(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Zc(t)&&t.Ch.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,$a(e.bh,r)];case 3:return null===(i=s.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e);var n=ph(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,nh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return oh(e)&&sh(e),[2]}}))}))}function oh(t){return Zc(t)&&!ph(t).zu()&&t.Ch.length>0}function sh(t){ph(t).start()}function uh(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){return ph(t).Eh(),[2]}))}))}function ah(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,lr.Jh)(this,(function(o){for(e=ph(t),n=0,r=t.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]}))}))}function ch(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=qu.from(r,e,n),[4,rh(t,(function(){return t.Dh.Bh(i)}))];case 1:return o.sent(),[4,ih(t)];case 2:return o.sent(),[2]}}))}))}function hh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e&&ph(t)._h?[4,function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return Yo(r=e.code)&&r!==kr.ABORTED?(n=t.Ch.shift(),ph(t).Yu(),[4,rh(t,(function(){return t.Dh.qh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,ih(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return oh(t)&&sh(t),[2]}}))}))}function fh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return n=Ir(t),e?(n.Nh.delete(2),[4,zc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,Bc(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function lh(t){var e=this;return t.Uh||(t.Uh=function(t,e,n){var r=Ir(t);return r.Ih(),new Uc(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:$c.bind(null,t),Tu:th.bind(null,t),ah:eh.bind(null,t)}),t.$h.push((function(n){return(0,lr.mG)(e,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Uh.Yu(),Xc(t)?Kc(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:e.sent(),Wc(t),e.label=3;case 3:return[2]}}))}))}))),t.Uh}function ph(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=Ir(t);return r.Ih(),new Gc(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:uh.bind(null,t),Tu:hh.bind(null,t),wh:ah.bind(null,t),dh:ch.bind(null,t)}),t.$h.push((function(n){return(0,lr.mG)(e,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Yu(),[4,ih(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:e.sent(),t.Ch.length>0&&(mr("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qh}var dh=function(){this.Kh=void 0,this.listeners=[]},vh=function(){this.queries=new ha((function(t){return oo(t)}),io),this.onlineState="Unknown",this.Wh=new Set};function yh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return(0,lr.Jh)(this,(function(c){switch(c.label){case 0:if(n=Ir(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new dh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.jh(r)];case 2:return s.Kh=c.sent(),[3,4];case 3:return u=c.sent(),a=vu(u,"Initialization of query '"+so(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Gh(n.onlineState),o.Kh&&e.zh(o.Kh)&&bh(n),[2]}}))}))}function mh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,lr.Jh)(this,(function(u){return n=Ir(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]}))}))}function gh(t,e){for(var n=Ir(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].zh(s)&&(r=!0);a.Kh=s}}r&&bh(n)}function wh(t,e,n){var r=Ir(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function bh(t){t.Wh.forEach((function(t){t.next()}))}var _h=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ds(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=ds.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),Eh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.sl=function(){return"metadata"in this.payload},t}(),Ih=function(){function t(t){this.Qt=t}return t.prototype.Pc=function(t){return Ls(this.Qt,t)},t.prototype.yc=function(t){return t.metadata.exists?js(this.Qt,t.document,!1):new Ni(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},t.prototype.gc=function(t){return ks(t)},t}();!function(){function t(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.ol=function(t){for(var e=new Map,n=new Ih(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||cs()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return[4,sc(this.bh,new Ih(this.Qt),this.documents,this.il.id)];case 1:t=o.sent(),e=this.ol(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,uc(this.bh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new qa(Object.assign({},this.progress),t))]}}))}))}}();var Th=function(t){this.key=t},Nh=function(t){this.key=t},Ah=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=cs(),this.De=cs(),this.hl=ao(t),this.ll=new ls(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new ps,i=e?e.ll:this.ll,o=e?e.De:this.De,s=i,u=!1,a=Xi(this.query)&&i.size===this.query.limit?i.last():null,c=Zi(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt((function(t,e){var h=i.get(t),f=e instanceof Ti?e:null;f&&(f=uo(n.query,f)?f:null);var l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.wl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.hl(f,a)>0||c&&n.hl(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Xi(this.query)||Zi(this.query))for(;s.size>this.query.limit;){var h=Xi(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:s,dl:r,lc:u,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}};return n(t)-n(e)}(t.type,e.type)||r.hl(t.doc,e.doc)})),this.El(n);var s=e?this.Tl():[],u=0===this.ul.size&&this.Be?1:0,a=u!==this.al;return this.al=u,0!==o.length||a?{snapshot:new ds(this.query,t.ll,i,o,t.De,0===u,a,!1),Il:s}:{Il:s}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new ps,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach((function(t){return e.cl=e.cl.add(t)})),t.Ue.forEach((function(t){})),t.Qe.forEach((function(t){return e.cl=e.cl.delete(t)})),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=cs(),this.ll.forEach((function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))}));var n=[];return e.forEach((function(e){t.ul.has(e)||n.push(new Nh(e))})),this.ul.forEach((function(t){e.has(t)||n.push(new Th(t))})),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=cs();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return ds.Ne(this.query,this.ll,this.De,0===this.al)},t}(),Sh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xh=function(t){this.key=t,this.Pl=!1},Dh=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new ha((function(t){return oo(t)}),io),this.Sl=new Map,this.Dl=new Set,this.Cl=new Xo(Hr.H),this.xl=new Map,this.Nl=new cc,this.$l={},this.Fl=new Map,this.Ol=wa.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(t.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),t}();function kh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return(0,lr.Jh)(this,(function(a){switch(a.label){case 0:return n=sf(t),(o=n.vl.get(e))?(r=o.targetId,n.Vl.Fa(r),i=o.view.Rl(),[3,4]):[3,1];case 1:return[4,tc(n.bh,no(e))];case 2:return s=a.sent(),u=n.Vl.Fa(s.targetId),r=s.targetId,[4,Oh(n,e,r,"current"===u)];case 3:i=a.sent(),n.Ml&&Jc(n.yl,s),a.label=4;case 4:return[2,i]}}))}))}function Oh(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return(0,lr.Jh)(this,(function(h){switch(h.label){case 0:return t.Ll=function(e,n,r){return function(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:return(i=e.view.fl(n)).lc?[4,nc(t.bh,e.query,!1).then((function(t){var n=t.documents;return e.view.fl(n,i)}))]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.$e.get(e.targetId),s=e.view.wi(i,t.Ml,o),[2,(Bh(t,e.targetId,s.Il),s.snapshot)]}}))}))}(t,e,n,r)},[4,nc(t.bh,e,!0)];case 1:return i=h.sent(),o=new Ah(e,i.Rc),s=o.fl(i.documents),u=ys.Le(n,r&&"Offline"!==t.onlineState),a=o.wi(s,t.Ml,u),Bh(t,n,a.Il),c=new Sh(e,n,o),[2,(t.vl.set(e,c),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),a.snapshot)]}}))}))}function Ph(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return n=Ir(t),r=n.vl.get(e),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter((function(t){return!io(t,e)}))),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,ec(n.bh,r.targetId,!1).then((function(){n.Vl.La(r.targetId),Hc(n.yl,r.targetId),qh(n,r.targetId)})).catch(ca)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return qh(n,r.targetId),[4,ec(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ch(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:r=uf(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ir(t),i=jr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),cs());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Tc.Xo(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=Lo(c,n.get(c.key));null!=h&&s.push(new Uo(c.key,h,Ei(h.proto.mapValue),Do.exists(!0)))}return r.zo.Ri(t,i,s,e)}))})).then((function(t){var e=t.xs(n);return{batchId:t.batchId,ri:e}}))}(r.bh,e)];case 2:return i=u.sent(),r.Vl.Ca(i.batchId),function(t,e,n){var r=t.$l[t.currentUser.A()];r||(r=new Xo(Ar)),r=r.zt(e,n),t.$l[t.currentUser.A()]=r}(r,i.batchId,n),[4,Qh(r,i.ri)];case 3:return u.sent(),[4,ih(r.yl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=vu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Lh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:n=Ir(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Za(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach((function(t,e){var r=n.xl.get(e);r&&(Er(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?Er(r.Pl):t.Qe.size>0&&(Er(r.Pl),r.Pl=!1))})),[4,Qh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ca(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Rh(t,e,n){var r=Ir(t);if(r.Ml&&0===n||!r.Ml&&1===n){var i=[];r.vl.forEach((function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ir(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)})),r&&bh(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ml&&r.Vl.Qa(e)}}function Vh(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return(0,lr.Jh)(this,(function(c){switch(c.label){case 0:return(r=Ir(t)).Vl.Ba(e,"rejected",n),i=r.xl.get(e),(o=i&&i.key)?(s=(s=new Xo(Hr.H)).zt(o,new Ni(o,Fr.min())),u=cs().add(o),a=new vs(Fr.min(),new Map,new $o(Ar),s,u),[4,Lh(r,a)]):[3,2];case 1:return c.sent(),r.Cl=r.Cl.remove(o),r.xl.delete(e),Hh(r),[3,4];case 2:return[4,ec(r.bh,e,!1).then((function(){return qh(r,e,n)})).catch(ca)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Mh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:n=Ir(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Ka(n.bh,e)];case 2:return i=o.sent(),Fh(n,r,null),jh(n,r),n.Vl.Na(r,"acknowledged"),[4,Qh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ca(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Uh(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:r=Ir(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.zo.Pi(t,e).next((function(e){return Er(null!==e),r=e.keys(),n.zo.Ci(t,e)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}(r.bh,e)];case 2:return i=o.sent(),Fh(r,e,n),jh(r,e),r.Vl.Na(e,"rejected",n),[4,Qh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ca(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Gh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:Zc((n=Ir(t)).yl)||mr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Ir(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.zo.Vi(t)}))}(n.bh)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Fl.get(r)||[]).push(e),n.Fl.set(r,i),[3,4]);case 3:return o=u.sent(),s=vu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function jh(t,e){(t.Fl.get(e)||[]).forEach((function(t){t.resolve()})),t.Fl.delete(e)}function Fh(t,e,n){var r=Ir(t),i=r.$l[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i}}function qh(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach((function(e){t.Nl.Fi(e)||zh(t,e)}))}function zh(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Hc(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Hh(t))}function Bh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Th?(t.Nl.nr(o.key,e),Jh(t,o)):o instanceof Nh?(mr("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Fi(o.key)||zh(t,o.key)):_r()}}function Jh(t,e){var n=e.key,r=n.path.rt();t.Cl.get(n)||t.Dl.has(r)||(mr("SyncEngine","New document in limbo: "+n),t.Dl.add(r),Hh(t))}function Hh(t){for(;t.Dl.size>0&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new Hr(zr.ot(e)),r=t.Ol.next();t.xl.set(r,new xh(n)),t.Cl=t.Cl.zt(n,r),Jc(t.yl,new ho(no(Ki(n.path)),r,2,Gr.q))}}function Qh(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:return r=Ir(t),i=[],o=[],s=[],r.vl.et()?[3,3]:(r.vl.forEach((function(t,u){s.push(r.Ll(u,e,n).then((function(t){if(t){r.Ml&&r.Vl.Ba(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Ba.oc(u.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.bl.ah(i),[4,function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h;return(0,lr.Jh)(this,(function(f){switch(f.label){case 0:n=Ir(t),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return iu.forEach(e,(function(e){return iu.forEach(e.ic,(function(r){return n.persistence.Ti.nr(t,e.targetId,r)})).next((function(){return iu.forEach(e.rc,(function(r){return n.persistence.Ti.ir(t,e.targetId,r)}))}))}))}))];case 2:return f.sent(),[3,4];case 3:if(!cu(r=f.sent()))throw r;return mr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],u=s.targetId,s.fromCache||(a=n.fc.get(u),c=a.Ot,h=a.Lt(c),n.fc=n.fc.zt(u,h));return[2]}}))}))}(r.bh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Yh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Ir(t)).currentUser.isEqual(e)?[3,3]:(mr("SyncEngine","User change. New user:",e.A()),[4,Ya(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fl.forEach((function(t){t.forEach((function(t){t.reject(new Or(kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fl.clear()}(n),n.Vl.Ua(e,r.mc,r.Ac),[4,Qh(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Kh(t,e){var n=Ir(t),r=n.xl.get(e);if(r&&r.Pl)return cs().add(r.key);var i=cs(),o=n.Sl.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.vl.get(a);i=i.Pe(c.view._l)}return i}function Xh(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return[4,nc((n=Ir(t)).bh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Al(r),[2,(n.Ml&&Bh(n,e.targetId,i.Il),i)]}}))}))}function Zh(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){return[2,ic((e=Ir(t)).bh).then((function(t){return Qh(e,t)}))]}))}))}function Wh(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o;return(0,lr.Jh)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Ir(t),r=Ir(n.zo);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.yi(t,e).next((function(e){return e?n.Tc.Xo(t,e):iu.resolve(null)}))}))}((i=Ir(t)).bh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,ih(i.yl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Fh(i,e,r||null),jh(i,e),function(t,e){Ir(Ir(t).zo).xi(e)}(i.bh,e)):_r(),s.label=4;case 4:return[4,Qh(i,o)];case 5:return s.sent(),[3,7];case 6:mr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function $h(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c;return(0,lr.Jh)(this,(function(h){switch(h.label){case 0:return sf(n=Ir(t)),uf(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,tf(n,r.it())]);case 1:return i=h.sent(),n.kl=!0,[4,fh(n.yl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],Jc(n.yl,u);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(a=[],c=Promise.resolve(),n.Sl.forEach((function(t,e){n.Vl.Ma(e)?a.push(e):c=c.then((function(){return qh(n,e),ec(n.bh,e,!0)})),Hc(n.yl,e)})),[4,c]);case 4:return h.sent(),[4,tf(n,a)];case 5:return h.sent(),function(t){var e=Ir(t);e.xl.forEach((function(t,n){Hc(e.yl,n)})),e.Nl.Oc(),e.xl=new Map,e.Cl=new Xo(Hr.H)}(n),n.kl=!1,[4,fh(n.yl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function tf(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h,f,l,p,d,v;return(0,lr.Jh)(this,(function(y){switch(y.label){case 0:n=Ir(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=s[o],a=void 0,(c=n.Sl.get(u))&&0!==c.length?[4,tc(n.bh,no(c[0]))]:[3,7]):[3,13];case 2:a=y.sent(),h=0,f=c,y.label=3;case 3:return h<f.length?(l=f[h],p=n.vl.get(l),[4,Xh(n,p)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,rc(n.bh,u)];case 8:return v=y.sent(),[4,tc(n.bh,v)];case 9:return a=y.sent(),[4,Oh(n,ef(v),u,!1)];case 10:y.sent(),y.label=11;case 11:r.push(a),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}}))}))}function ef(t){return Yi(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function nf(t){var e=Ir(t);return Ir(Ir(e.bh).persistence).Uo()}function rf(t,e,n,r){return(0,lr.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,lr.Jh)(this,(function(u){switch(u.label){case 0:return(i=Ir(t)).kl?(mr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,ic(i.bh)];case 3:return o=u.sent(),s=vs.Me(e,"current"===n),[4,Qh(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,ec(i.bh,e,!0)];case 6:return u.sent(),qh(i,e,r),[3,8];case 7:_r(),u.label=8;case 8:return[2]}}))}))}function of(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h,f,l;return(0,lr.Jh)(this,(function(p){switch(p.label){case 0:if(!(r=sf(t)).kl)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Sl.has(s)?(mr("SyncEngine","Adding an already active target "+s),[3,5]):[4,rc(r.bh,s)]):[3,6];case 2:return u=p.sent(),[4,tc(r.bh,u)];case 3:return a=p.sent(),[4,Oh(r,ef(u),a.targetId,!1)];case 4:p.sent(),Jc(r.yl,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,ec(r.bh,t,!1).then((function(){Hc(r.yl,t),qh(r,t)})).catch(ca)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,p.label=7;case 7:return h<f.length?(l=f[h],[5,c(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function sf(t){var e=Ir(t);return e.yl.Dh.Lh=Lh.bind(null,e),e.yl.Dh.vn=Kh.bind(null,e),e.yl.Dh.Mh=Vh.bind(null,e),e.bl.ah=gh.bind(null,e.gl),e.bl.Bl=wh.bind(null,e.gl),e}function uf(t){var e=Ir(t);return e.yl.Dh.Bh=Mh.bind(null,e),e.yl.Dh.qh=Uh.bind(null,e),e}var af=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return this.Qt=Rc(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}}))}))},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return Qa(this.persistence,new Ja,t.Jl,this.Qt)},t.prototype.jl=function(t){return new vc(mc.ia,this.Qt)},t.prototype.Wl=function(t){return new Sc},t.prototype.terminate=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}}))}))},t}(),cf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,lr.ZT)(e,t),e.prototype.initialize=function(e){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,oc(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,uf(this.Yl._a)];case 4:return n.sent(),[4,ih(this.Yl.yl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Hl=function(t){return Qa(this.persistence,new Ja,t.Jl,this.Qt)},e.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new Aa(e,t._s)},e.prototype.jl=function(t){var e=Fa(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?aa.Ys(this.cacheSizeBytes):aa.ti;return new Ua(this.synchronizeTabs,e,t.clientId,n,t._s,Cc(),Lc(),this.Qt,this.Vl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new Sc},e}(af),hf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,lr.ZT)(e,t),e.prototype.initialize=function(e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Yl._a,this.Vl instanceof Ac?(this.Vl._a={eu:Wh.bind(null,n),nu:rf.bind(null,n),su:of.bind(null,n),Uo:nf.bind(null,n),tu:Zh.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Ro((function(t){return(0,lr.mG)(r,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return[4,$h(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=Cc();if(!Ac.Kn(e))throw new Or(kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Fa(t.yu.t,t.yu.persistenceKey);return new Ac(e,t._s,n,t.clientId,t.Jl)},e}(cf),ff=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n=this;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return Rh(n._a,t,1)},this.yl.Dh.n_=Yh.bind(null,this._a),[4,fh(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.t_=function(t){return new vh},t.prototype.Xl=function(t){var e,n=Rc(t.yu.t),r=(e=t.yu,new Pc(e));return function(t,e,n){return new jc(t,e,n)}(t.credentials,r,n)},t.prototype.Zl=function(t){var e,n,r,i,o,s=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return Rh(s._a,t,0)},o=Dc.Kn()?new Dc:new xc,new qc(e,n,r,i,o)},t.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Dh(t,e,n,r,i,o);return s&&(u.kl=!0),u}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},t.prototype.terminate=function(){return function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e=Ir(t),mr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Bc(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}}))}))}(this.yl)},t}(),lf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),pf=(function(){function t(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new ru,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then((function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.r_.cancel()},t.prototype.getMetadata=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Ql=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}}))}))},t.prototype.c_=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e,n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.a_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.o_.decode(t),n=Number(e),isNaN(n)&&this.u_("length string ("+e+") is not valid number"),[4,this.h_(n)]);case 2:return r=i.sent(),[2,new Eh(JSON.parse(r),t.length+n)]}}))}))},t.prototype.l_=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.a_=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.h_=function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.__=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new Jr(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}()),df=function(t){this._methodName=t},vf=function(t){this.d_=t};function yf(t,e,n){if(!n)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function mf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Or(kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function gf(t,e,n,r){if(!0===e&&!0===r)throw new Or(kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function wf(t){if(!Hr.wt(t))throw new Or(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function bf(t){if(Hr.wt(t))throw new Or(kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function _f(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":_r()}function Ef(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Or(kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=_f(t);throw new Or(kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function If(t,e){if(e<=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Tf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Or(kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Or(kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,gf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Nf=new Map,Af=function(){function t(t,e){this.w_="(lite)",this.E_=new Tf({}),this.T_=!1,t instanceof dr?(this.I_=t,this.m_=new Rr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Or(kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dr(t.options.projectId)}(t),this.m_=new Vr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new Or(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Tf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Rr;switch(t.type){case"gapi":var e=t.client;return Er(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ur(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Or(kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return(t=Nf.get(this))&&(mr("ComponentProvider","Removing Datastore"),Nf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Sf=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Df(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),xf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Df=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Ki(r))||this).firestore=e,i.D_=r,i.type="collection",i}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Sf(this.firestore,null,new Hr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(xf);function kf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof vf&&(t=t.d_),yf("collection","path",e),t instanceof Af)return bf(n=zr.ot.apply(zr,(0,lr.pr)([e],r))),new Df(t,null,n);if(!(t instanceof Sf||t instanceof Df))throw new Or(kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return bf(n=zr.ot.apply(zr,(0,lr.pr)([t.path],r)).child(zr.ot(e))),new Df(t.firestore,null,n)}function Of(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof vf&&(t=t.d_),1===arguments.length&&(e=Nr.u()),yf("doc","path",e),t instanceof Af)return wf(n=zr.ot.apply(zr,(0,lr.pr)([e],r))),new Sf(t,null,new Hr(n));if(!(t instanceof Sf||t instanceof Df))throw new Or(kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wf(n=t.D_.child(zr.ot.apply(zr,(0,lr.pr)([e],r)))),new Sf(t.firestore,t instanceof Df?t.v_:null,new Hr(n))}function Pf(t,e){return t instanceof vf&&(t=t.d_),e instanceof vf&&(e=e.d_),(t instanceof Sf||t instanceof Df)&&(e instanceof Sf||e instanceof Df)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Cf(t,e){return t instanceof vf&&(t=t.d_),e instanceof vf&&(e=e.d_),t instanceof xf&&e instanceof xf&&t.firestore===e.firestore&&io(t.C_,e.C_)&&t.v_===e.v_}var Lf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Or(kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Or(kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return Ar(this.x_,t.x_)||Ar(this.N_,t.N_)},t}(),Rf=/^__.*__$/,Vf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new Uo(t,this.data,this.Gt,e,this.fieldTransforms):new Mo(t,this.data,e,this.fieldTransforms)},t}(),Mf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Uo(t,this.data,this.Gt,e,this.fieldTransforms)},t}();function Uf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _r()}}var Gf=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return ol(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find((function(e){return t.nt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.nt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Uf(this.k_)&&Rf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),jf=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Rc(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Gf({k_:t,methodName:e,j_:n,path:Jr.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function Ff(t){var e=t.p_(),n=Rc(t.I_);return new jf(t.I_,!!e.ignoreUndefinedProperties,n)}function qf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);el("Data must be an object, but it was:",s,r);var u,a,c=$f(r,s);if(o.merge)u=new Xr(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=nl(e,l[f],n);if(!s.contains(p))throw new Or(kr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");sl(h,p)||h.push(p)}u=new Xr(h),a=s.fieldTransforms.filter((function(t){return u.Tt(t.field)}))}else u=null,a=s.fieldTransforms;return new Vf(new bi(c),u,a)}var zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(df);function Bf(t,e,n){return new Gf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.z_=function(t){return new So(t.path,new wo)},e.prototype.isEqual=function(t){return t instanceof e},e}(df),Hf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,lr.ZT)(e,t),e.prototype.z_=function(t){var e=Bf(this,t,!0),n=this.H_.map((function(t){return Wf(t,e)})),r=new bo(n);return new So(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(df),Qf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,lr.ZT)(e,t),e.prototype.z_=function(t){var e=Bf(this,t,!0),n=this.H_.map((function(t){return Wf(t,e)})),r=new Eo(n);return new So(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(df),Yf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return(0,lr.ZT)(e,t),e.prototype.z_=function(t){var e=new To(t.Qt,po(t.Qt,this.J_));return new So(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(df);function Kf(t,e,n,r){var i=t.G_(1,e,n);el("Data must be an object, but it was:",i,r);var o=[],s=new _i;Yr(r,(function(t,r){var u=il(e,t,n);r instanceof vf&&(r=r.d_);var a=i.U_(u);if(r instanceof zf)o.push(u);else{var c=Wf(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new Xr(o);return new Mf(s.Pt(),u,i.fieldTransforms)}function Xf(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[nl(e,r,n)],a=[i];if(o.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(nl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new _i,l=u.length-1;l>=0;--l)if(!sl(h,u[l])){var p=u[l],d=a[l];d instanceof vf&&(d=d.d_);var v=s.U_(p);if(d instanceof zf)h.push(p);else{var y=Wf(d,v);null!=y&&(h.push(p),f.set(p,y))}}var m=new Xr(h);return new Mf(f.Pt(),m,s.fieldTransforms)}function Zf(t,e,n,r){return void 0===r&&(r=!1),Wf(n,t.G_(r?4:3,e))}function Wf(t,e){if(t instanceof vf&&(t=t.d_),tl(t))return el("Unsupported field value:",e,t),$f(t,e);if(t instanceof df)return function(t,e){if(!Uf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Wf(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof vf&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return po(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=jr.fromDate(t);return{timestampValue:Ss(e.Qt,n)}}if(t instanceof jr)return n=new jr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ss(e.Qt,n)};if(t instanceof Lf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Pr)return{bytesValue:xs(e.Qt,t.I)};if(t instanceof Sf){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Os(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+_f(t))}(t,e)}function $f(t,e){var n={};return Kr(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):Yr(t,(function(t,r){var i=Wf(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function tl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof jr||t instanceof Lf||t instanceof Pr||t instanceof Sf||t instanceof df)}function el(t,e,n){if(!tl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=_f(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function nl(t,e,n){if(e instanceof vf&&(e=e.d_),e instanceof pf)return e.f_;if("string"==typeof e)return il(t,e);throw ol("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var rl=new RegExp("[~\\*/\\[\\]]");function il(t,e,n){if(e.search(rl)>=0)throw ol("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(pf.bind.apply(pf,(0,lr.pr)([void 0],e.split("."))))).f_}catch(r){throw ol("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ol(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Or(kr.INVALID_ARGUMENT,(u+=". ")+t+a)}function sl(t,e){return t.some((function(t){return t.isEqual(e)}))}var ul=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new Or(kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return(0,lr.Jh)(this,(function(a){switch(a.label){case 0:return n=Ir(t),r=Ms(n.Qt)+"/documents",i={documents:e.map((function(t){return Cs(n.Qt,t)}))},[4,n.Du("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Er(!!e.found),e.found.name,e.found.updateTime;var n=Ls(t,e.found.name),r=ks(e.found.updateTime),i=new bi({mapValue:{fields:e.found.fields}});return new Ti(n,r,i,{})}(t,e):"missing"in e?function(t,e){Er(!!e.missing),Er(!!e.readTime);var n=Ls(t,e.missing),r=ks(e.readTime);return new Ni(n,r)}(t,e):_r()}(n.Qt,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Er(!!e),u.push(e)})),u)]}}))}))}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Ni||t instanceof Ti?n.sf(t):_r()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Jo(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Hr._t(n);e.mutations.push(new Ho(r,e.jt(r)))})),[4,function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return n=Ir(t),r=Ms(n.Qt)+"/documents",i={writes:e.map((function(t){return Fs(n.Qt,t)}))},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof Ti)e=t.version;else{if(!(t instanceof Ni))throw _r();e=Fr.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Or(kr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Do.updateTime(e):Do.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(Fr.min()))throw new Or(kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Do.updateTime(e)}return Do.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),al=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Vc(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.Lu((function(){return(0,lr.mG)(t,void 0,void 0,(function(){var t,e,n=this;return(0,lr.Jh)(this,(function(r){return t=new ul(this.Sh),(e=this.uf(t))&&e.then((function(e){n._s.Ps((function(){return t.commit().then((function(){n.Es.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ii(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps((function(){return e.af(),Promise.resolve()}))):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Yo(e)}return!1},t}(),cl=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Cr.UNAUTHENTICATED,this.clientId=Nr.u(),this._f=function(){},this.C=new ru,this.credentials.v((function(t){mr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()}))}return t.prototype.getConfiguration=function(){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this._s.wf)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new ru;return this._s.Tf((function(){return(0,lr.mG)(t,void 0,void 0,(function(){var t,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=vu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function hl(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r,i=this;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return t._s.Af(),mr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Jl,t.ff((function(n){r.isEqual(n)||(r=n,t._s.po((function(){return(0,lr.mG)(i,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(t){switch(t.label){case 0:return[4,Ya(e.bh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Po((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function fl(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return t._s.Af(),[4,ll(t)];case 1:return n=i.sent(),mr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t._s.po((function(){return function(t,e){return(0,lr.mG)(this,void 0,void 0,(function(){var n,r;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Ir(t))._s.Af(),mr("RemoteStore","RemoteStore received new credentials"),r=Zc(n),n.Nh.add(3),[4,Bc(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,zc(n)];case 3:return i.sent(),[2]}}))}))}(e.yl,n)}))})),t.If=e,[2]}}))}))}function ll(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(mr("FirestoreClient","Using default OfflineComponentProvider"),[4,hl(t,new af)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function pl(t){return(0,lr.mG)(this,void 0,void 0,(function(){return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(mr("FirestoreClient","Using default OnlineComponentProvider"),[4,fl(t,new ff)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function dl(t){return ll(t).then((function(t){return t.persistence}))}function vl(t){return ll(t).then((function(t){return t.bh}))}function yl(t){return pl(t).then((function(t){return t.yl}))}function ml(t){return pl(t).then((function(t){return t._a}))}function gl(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return[4,pl(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=kh.bind(null,e._a),n.Hh=Ph.bind(null,e._a),n)]}}))}))}function wl(t,e,n){var r=this;void 0===n&&(n={});var i=new ru;return t._s.Ps((function(){return(0,lr.mG)(r,void 0,void 0,(function(){var r;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new lf({next:function(o){e.Ps((function(){return mh(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Or(kr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Or(kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new _h(Ki(n.path),o,{includeMetadataChanges:!0,nl:!0});return yh(t,s)},[4,gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}function bl(t,e,n){var r=this;void 0===n&&(n={});var i=new ru;return t._s.Ps((function(){return(0,lr.mG)(r,void 0,void 0,(function(){var r;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new lf({next:function(n){e.Ps((function(){return mh(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Or(kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new _h(n,o,{includeMetadataChanges:!0,nl:!0});return yh(t,s)},[4,gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}var _l=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Vc(this,"async_queue_retry"),this.vf=function(){var e=Lc();e&&mr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=Lc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Lc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!cu(t=n.sent()))throw t;return mr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,gr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=du.Ts(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&_r()},t.prototype.Af=function(){},t.prototype.Nf=function(){return(0,lr.mG)(this,void 0,void 0,(function(){var t;return(0,lr.Jh)(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ds-e.ds}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()}))},t.prototype.Of=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function El(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this.kf={},this.Mf=new ru,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Mf.promise.catch(t)},t.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},t.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},t.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},t.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)}}();var Il=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new _l,r.w_="name"in e?e.name:"[DEFAULT]",r}return(0,lr.ZT)(e,t),e.prototype.b_=function(){return this.qf||Nl(this),this.qf.terminate()},e}(Af);function Tl(t){return t.qf||Nl(t),t.qf.df(),t.qf}function Nl(t){var e=t.p_(),n=function(t,e,n){return new pr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.qf=new cl(t.m_,t.Bf,n)}function Al(t,e,n){var r=this,i=new ru;return t._s.enqueue((function(){return(0,lr.mG)(r,void 0,void 0,(function(){var r;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,hl(t,n)];case 1:return o.sent(),[4,fl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===kr.FAILED_PRECONDITION||t.code===kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Sl(t){if(t.R_||t.P_)throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var xl=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),ui(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $r(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(ti(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw _r()}},t.prototype.Hf=function(t,e){var n=this,r={};return Yr(t.fields||{},(function(t,i){r[t]=n.Uf(i,e)})),r},t.prototype.Gf=function(t){return new Lf($r(t.latitude),$r(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.Uf(t,e)}))},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=ni(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(ri(t));default:return null}},t.prototype.Qf=function(t){var e=Wr(t);return new jr(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=zr.ot(t);Er(nu(n));var r=new dr(n.get(1),n.get(3)),i=new Hr(n.Y(5));return r.isEqual(e)||gr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Dl=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Sf(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new kl(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(Ol("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),kl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Dl);function Ol(t,e){return"string"==typeof e?il(t,e):e instanceof vf?e.d_.f_:e.f_}function Pl(t){if(Zi(t)&&0===t.xt.length)throw new Or(kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Cl=function(){};function Ll(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var Rl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return(0,lr.ZT)(e,t),e.prototype.td=function(t){var e=Ff(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ql(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Fl(r,t,f))}u={arrayValue:{values:a}}}else u=Fl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ql(s,o),u=Zf(n,"where",s,"in"===o||"not-in"===o);var l=Pi.create(i,o,u);return function(t,e){if(e.Ct()){var n=$i(t);if(null!==n&&!n.isEqual(e.field))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Wi(t);null!==r&&zl(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.I_,this.ed,this.nd,this.sd);return new xf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Qi(t.path,t.collectionGroup,t.xt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Cl),Vl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return(0,lr.ZT)(e,t),e.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new zi(e,n);return function(t,e){if(null===Wi(t)){var n=$i(t);null!==n&&zl(0,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new xf(t.firestore,t.v_,function(t,e){var n=t.xt.concat([e]);return new Qi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Cl),Ml=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return(0,lr.ZT)(e,t),e.prototype.td=function(t){return new xf(t.firestore,t.v_,ro(t.C_,this.od,this.ad))},e}(Cl),Ul=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return(0,lr.ZT)(e,t),e.prototype.td=function(t){var e=jl(t,this.type,this.ud,this.hd);return new xf(t.firestore,t.v_,function(t,e){return new Qi(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Cl),Gl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return(0,lr.ZT)(e,t),e.prototype.td=function(t){var e=jl(t,this.type,this.ud,this.hd);return new xf(t.firestore,t.v_,function(t,e){return new Qi(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Cl);function jl(t,e,n,r){if(n[0]instanceof vf&&(n[0]=n[0].d_),n[0]instanceof Dl)return function(t,e,n,r,i){if(!r)throw new Or(kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=eo(t);s<u.length;s++){var a=u[s];if(a.field.ut())o.push(di(e,r.key));else{var c=r.field(a.field);if(ei(c))throw new Or(kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.rt();throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Fi(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=Ff(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Or(kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!to(t)&&-1!==c.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(zr.ot(c));if(!Hr.wt(h))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Hr(h);u.push(di(e,f))}else{var l=Zf(n,r,c);u.push(l)}}return new Fi(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Fl(t,e,n){if(n instanceof vf&&(n=n.d_),"string"==typeof n){if(""===n)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!to(e)&&-1!==n.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(zr.ot(n));if(!Hr.wt(r))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return di(t,new Hr(r))}if(n instanceof Sf)return di(t,n.S_);throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+_f(n)+".")}function ql(t,e){if(!Array.isArray(t)||0===t.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function zl(t,e,n){if(!n.isEqual(e))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Bl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Jl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,lr.ZT)(e,t),e.prototype.Wf=function(t){return new Pr(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Sf(this.firestore,null,e)},e}(xl),Hl=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Ql=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).Yf=e,u.ld=e,u.metadata=o,u}return(0,lr.ZT)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Yl(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(Ol("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},e}(Dl),Yl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Ql),Kl=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Hl(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach((function(r){t.call(e,new Yl(n.Yf,n.Xf,r.key,r,new Hl(n._d.De.has(r.key),n._d.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new Or(kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map((function(e){var r=new Yl(t.Yf,t.Xf,e.doc.key,e.doc,new Hl(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._d.Se;return t._d.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Yl(t.Yf,t.Xf,e.doc.key,e.doc,new Hl(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xl(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.dd=e),this.fd},t}();function Xl(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}function Zl(t,e){return t instanceof Ql&&e instanceof Ql?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Kl&&e instanceof Kl&&t.Yf===e.Yf&&Cf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var Wl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,lr.ZT)(e,t),e.prototype.Wf=function(t){return new Pr(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Sf(this.firestore,null,e)},e}(xl);function $l(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ef(t,Sf);var o=Ef(t.firestore,Il),s=Ff(o);return e instanceof vf&&(e=e.d_),ep(o,[("string"==typeof e||e instanceof pf?Xf(s,"updateDoc",t.S_,e,n,r):Kf(s,"updateDoc",t.S_,e)).F_(t.S_,Do.exists(!0))])}function tp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof vf&&(t=t.d_);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||El(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(El(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof Sf)c=Ef(t.firestore,Il),h=Ki(t.S_.path),a={next:function(e){i[u]&&i[u](np(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Ef(t,xf);c=Ef(p.firestore,Il),h=p.C_;var d=new Wl(c);a={next:function(t){i[u]&&i[u](new Kl(c,d,p,t))},error:i[u+1],complete:i[u+2]},Pl(t.C_)}return function(t,e,n,r){var i=this,o=new lf(r),s=new _h(e,o,n);return t._s.Ps((function(){return(0,lr.mG)(i,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e=yh,[4,gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.i_(),t._s.Ps((function(){return(0,lr.mG)(i,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e=mh,[4,gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(Tl(c),h,f,a)}function ep(t,e){return function(t,e){var n=this,r=new ru;return t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var n;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return n=Ch,[4,ml(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Tl(t),e)}function np(t,e,n){var r=n.docs.get(e.S_),i=new Wl(t);return new Ql(t,i,e.S_,r,new Hl(n.hasPendingWrites,n.fromCache),e.v_)}var rp=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=Ff(t)}return t.prototype.set=function(t,e,n){this.md();var r=ip(t,this.Yf),i=Bl(r.v_,e,n),o=qf(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,Do.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,s=ip(t,this.Yf);return e instanceof vf&&(e=e.d_),o="string"==typeof e||e instanceof pf?Xf(this.Id,"WriteBatch.update",s.S_,e,n,r):Kf(this.Id,"WriteBatch.update",s.S_,e),this.Ed.push(o.F_(s.S_,Do.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=ip(t,this.Yf);return this.Ed=this.Ed.concat(new Jo(e.S_,Do.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new Or(kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function ip(t,e){if(t instanceof vf&&(t=t.d_),t.firestore!==e)throw new Or(kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var op=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return(0,lr.ZT)(e,t),e.prototype.get=function(e){var n=this,r=ip(e,this.Yf),i=new Wl(this.Yf);return t.prototype.get.call(this,e).then((function(t){return new Ql(n.Yf,i,r.S_,t.Zf,new Hl(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=Ff(t)}return t.prototype.get=function(t){var e=this,n=ip(t,this.Yf),r=new Jl(this.Yf);return this.Ad.ef([n.S_]).then((function(t){if(!t||1!==t.length)return _r();var i=t[0];if(i instanceof Ni)return new Dl(e.Yf,r,n.S_,null,n.v_);if(i instanceof Ti)return new Dl(e.Yf,r,i.key,i,n.v_);throw _r()}))},t.prototype.set=function(t,e,n){var r=ip(t,this.Yf),i=Bl(r.v_,e,n),o=qf(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=ip(t,this.Yf);return e instanceof vf&&(e=e.d_),o="string"==typeof e||e instanceof pf?Xf(this.Id,"Transaction.update",s.S_,e,n,r):Kf(this.Id,"Transaction.update",s.S_,e),this.Ad.update(s.S_,o),this},t.prototype.delete=function(t){var e=ip(t,this.Yf);return this.Ad.delete(e.S_),this},t}());function sp(){if("undefined"==typeof Uint8Array)throw new Or(kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function up(){if("undefined"==typeof atob)throw new Or(kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.fromBase64String=function(t){return up(),new e(Pr.fromBase64String(t))},e.fromUint8Array=function(t){return sp(),new e(Pr.fromUint8Array(t))},e.prototype.toBase64=function(){return up(),this.d_.toBase64()},e.prototype.toUint8Array=function(){return sp(),this.d_.toUint8Array()},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(vf),cp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Sl(t=Ef(t,Il));var n=Tl(t),r=t.p_(),i=new ff;return Al(n,i,new cf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Sl(t=Ef(t,Il));var e=Tl(t),n=t.p_(),r=new ff;return Al(e,r,new hf(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Or(kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ru;return t.Bf.Tf((function(){return(0,lr.mG)(e,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return su.Kn()?(e=t+"main",[4,su.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Fa(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.d_)},t}(),hp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof dr||(i.Pd=e),i}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Ef(t,Af)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&wr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this.d_,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return(0,lr.mG)(e,void 0,void 0,(function(){var e,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return[4,dl(t)];case 1:return e=r.sent(),[4,yl(t)];case 2:return n=r.sent(),[2,(e.yo(!0),function(t){var e=Ir(t);return e.Nh.delete(0),zc(e)}(n))]}}))}))}))}(Tl(Ef(this.d_,Il)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return(0,lr.mG)(e,void 0,void 0,(function(){var e,n;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return[4,dl(t)];case 1:return e=r.sent(),[4,yl(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return(0,lr.mG)(this,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Ir(t)).Nh.add(0),[4,Bc(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Tl(Ef(this.d_,Il)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&gf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ru;return t._s.Ps((function(){return(0,lr.mG)(e,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(r){switch(r.label){case 0:return e=Gh,[4,ml(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Tl(Ef(this.d_,Il)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new lf(e);return t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ir(t).Wh.add(e),e.next()},[4,gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.i_(),t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var e;return(0,lr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ir(t).Wh.delete(e)},[4,gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Tl(t=Ef(t,Il)),El(e)?e:{next:e})}(this.d_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Pd)throw new Or(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Tp(this,kf(this.d_,t))}catch(t){throw yp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new vp(this,Of(this.d_,t))}catch(t){throw yp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new _p(this,function(t,e){if(t=Ef(t,Af),yf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new xf(t,null,function(t){return new Qi(zr.ct(),t)}(e))}(this.d_,t))}catch(t){throw yp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new ru;return t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var n;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return[4,function(t){return pl(t).then((function(t){return t.Sh}))}(t)];case 1:return n=i.sent(),new al(t._s,n,e,r).run(),[2]}}))}))})),r.promise}(Tl(t),(function(n){return e(new op(t,n))}))}(this.d_,(function(n){return t(new lp(e,n))}))},e.prototype.batch=function(){var t=this;return Tl(this.d_),new pp(new rp(this.d_,(function(e){return ep(t.d_,e)})))},e.prototype.loadBundle=function(t){throw new Or(kr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Or(kr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(vf),fp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,lr.ZT)(e,t),e.prototype.Wf=function(t){return new ap(new Pr(t))},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return vp.yd(e,this.firestore,null)},e}(xl),lp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new fp(e),r}return(0,lr.ZT)(e,t),e.prototype.get=function(t){var e=this,n=Np(t);return this.d_.get(n).then((function(t){return new wp(e.Yf,new Ql(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))}))},e.prototype.set=function(t,e,n){var r=Np(t);return n?(mf("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Np(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,(0,lr.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Np(t);return this.d_.delete(e),this},e}(vf),pp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.set=function(t,e,n){var r=Np(t);return n?(mf("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Np(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,(0,lr.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Np(t);return this.d_.delete(e),this},e.prototype.commit=function(){return this.d_.commit()},e}(vf),dp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return(0,lr.ZT)(e,t),e.prototype.fromFirestore=function(t,e){var n=new Yl(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new bp(this.Yf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},e.gd=function(t,n){var r=e.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new fp(t),n),i.set(n,o)),o},e}(vf);dp.Vd=new WeakMap;var vp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new fp(e),r}return(0,lr.ZT)(e,t),e.pd=function(t,n,r){if(t.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new e(n,new Sf(n.d_,r,new Hr(t)))},e.yd=function(t,n,r){return new e(n,new Sf(n.d_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Tp(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Tp(this.firestore,kf(this.d_,t))}catch(t){throw yp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof vf&&(t=t.d_),t instanceof Sf&&Pf(this.d_,t)},e.prototype.set=function(t,e){e=mf("DocumentReference.set",e);try{return function(t,e,n){t=Ef(t,Sf);var r=Ef(t.firestore,Il),i=Bl(t.v_,e,n);return ep(r,[qf(Ff(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Do.Kt())])}(this.d_,t,e)}catch(t){throw yp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?$l(this.d_,t):$l.apply(void 0,(0,lr.pr)([this.d_,t,e],n))}catch(t){throw yp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return ep(Ef((t=this.d_).firestore,Il),[new Jo(t.S_,Do.Kt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=mp(e),i=gp(e,(function(e){return new wp(t.firestore,new Ql(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))}));return tp(this.d_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ef(t,Sf);var e=Ef(t.firestore,Il),n=Tl(e),r=new Wl(e);return function(t,e){var n=this,r=new ru;return t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var n;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i;return(0,lr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Tc.Ho(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof Ti?n.resolve(i):i instanceof Ni?n.resolve(null):n.reject(new Or(kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=vu(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,vl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new Ql(e,r,t.S_,n,new Hl(n instanceof Ti&&n.Vt,!0),t.v_)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Ef(t,Sf);var e=Ef(t.firestore,Il);return wl(Tl(e),t.S_,{source:"server"}).then((function(n){return np(e,t,n)}))}(this.d_):function(t){t=Ef(t,Sf);var e=Ef(t.firestore,Il);return wl(Tl(e),t.S_).then((function(n){return np(e,t,n)}))}(this.d_)).then((function(t){return new wp(e.firestore,new Ql(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(dp.gd(this.firestore,t)))},e}(vf);function yp(t,e,n){return t.message=t.message.replace(e,n),t}function mp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!El(r))return r}return{}}function gp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=El(t[0])?t[0]:El(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var wp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new vp(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.d_.data(t)},e.prototype.get=function(t,e){return this.d_.get(t,e)},e.prototype.isEqual=function(t){return Zl(this.d_,t.d_)},e}(vf),bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.prototype.data=function(t){return this.d_.data(t)},e}(wp),_p=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new fp(e),r}return(0,lr.ZT)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Ll(this.d_,function(t,e,n){var r=e,i=Ol("where",t);return new Rl(i,r,n)}(t,n,r)))}catch(t){throw yp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Ll(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=Ol("orderBy",t);return new Vl(r,n)}(t,n)))}catch(t){throw yp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Ll(this.d_,function(t){return If("limit",t),new Ml("limit",t,"F")}(t)))}catch(t){throw yp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Ll(this.d_,function(t){return If("limitToLast",t),new Ml("limitToLast",t,"L")}(t)))}catch(t){throw yp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ll(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ul("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw yp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ll(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ul("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw yp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ll(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Gl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw yp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Ll(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Gl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw yp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Cf(this.d_,t.d_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ef(t,xf);var e=Ef(t.firestore,Il),n=Tl(e),r=new Wl(e);return function(t,e){var n=this,r=new ru;return t._s.Ps((function(){return(0,lr.mG)(n,void 0,void 0,(function(){var n;return(0,lr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,lr.mG)(this,void 0,void 0,(function(){var r,i,o,s,u;return(0,lr.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,nc(t,e,!0)];case 1:return u=a.sent(),r=new Ah(e,u.Rc),i=r.fl(u.documents),o=r.wi(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),u=vu(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))},[4,vl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new Kl(e,r,t,n)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Ef(t,xf);var e=Ef(t.firestore,Il),n=Tl(e),r=new Wl(e);return bl(n,t.C_,{source:"server"}).then((function(n){return new Kl(e,r,t,n)}))}(this.d_):function(t){t=Ef(t,xf);var e=Ef(t.firestore,Il),n=Tl(e),r=new Wl(e);return Pl(t.C_),bl(n,t.C_).then((function(n){return new Kl(e,r,t,n)}))}(this.d_)).then((function(t){return new Ip(e.firestore,new Kl(e.firestore.d_,e.Xf,e.d_,t._d))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=mp(e),i=gp(e,(function(e){return new Ip(t.firestore,new Kl(t.firestore.d_,t.Xf,t.d_,e._d))}));return tp(this.d_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(dp.gd(this.firestore,t)))},e}(vf),Ep=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new bp(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),e}(vf),Ip=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new _p(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map((function(e){return new bp(t.Yf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map((function(t){return new Ep(e.Yf,t)}))},e.prototype.forEach=function(t,e){var n=this;this.d_.forEach((function(r){t.call(e,new bp(n.Yf,r))}))},e.prototype.isEqual=function(t){return Zl(this.d_,t.d_)},e}(vf),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return(0,lr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new vp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new vp(this.firestore,void 0===t?Of(this.d_):Of(this.d_,t))}catch(t){throw yp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Ef(t.firestore,Il),r=Of(t),i=Bl(t.v_,e);return ep(n,[qf(Ff(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Do.exists(!1))]).then((function(){return r}))}(this.d_,t).then((function(t){return new vp(e.firestore,t)}))},e.prototype.isEqual=function(t){return Pf(this.d_,t.d_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(dp.gd(this.firestore,t)))},e}(_p);function Np(t){return t instanceof vf&&(t=t.d_),Ef(t,Sf)}var Ap,Sp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(pf.bind.apply(pf,(0,lr.pr)([void 0],e))))||this}return(0,lr.ZT)(e,t),e.documentId=function(){return new e(Jr.ht().rt())},e.prototype.isEqual=function(t){return t instanceof vf&&(t=t.d_),t instanceof pf&&this.d_.f_.isEqual(t.f_)},e}(vf),xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,lr.ZT)(e,t),e.serverTimestamp=function(){var t=new Jf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new zf("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hf("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qf("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Yf("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e}(vf),Dp=n(9455),kp={Firestore:hp,GeoPoint:Lf,Timestamp:jr,Blob:ap,Transaction:lp,WriteBatch:pp,DocumentReference:vp,DocumentSnapshot:wp,Query:_p,QueryDocumentSnapshot:bp,QuerySnapshot:Ip,CollectionReference:Tp,FieldPath:Sp,FieldValue:xp,setLogLevel:function(t){var e;e=t,vr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Dp.wA("firestore",(function(t){return function(t,e){return new hp(t,new Il(t,e),new cp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},kp)))})(Ap=r.Z),Ap.registerVersion("@firebase/firestore","2.1.7")}}]);